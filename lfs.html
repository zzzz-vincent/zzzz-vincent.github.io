<!DOCTYPE html><html lang="en-US"><head><meta name="viewport" content="width=device-width"/><title>Log-structured File System (LFS)</title><meta name="robots" content="follow, index"/><meta charSet="UTF-8"/><meta name="keywords" content="Blog, Website, Notion"/><meta name="description" content="Storage As Log"/><meta property="og:type" content="Post"/><meta property="og:title" content="Log-structured File System (LFS)"/><meta property="og:description" content="Storage As Log"/><meta property="og:url" content="https://zzzz-vincent.vercel.app/lfs"/><meta property="og:locale" content="en-US"/><meta property="og:image" content="https://og-image-korean.vercel.app/Log-structured%20File%20System%20(LFS).png?theme=dark&amp;md=1&amp;fontSize=125px&amp;images=https%3A%2F%2Fmorethan-log.vercel.app%2Flogo-for-dark-bg.svg"/><meta name="twitter:title" content="Log-structured File System (LFS)"/><meta name="twitter:description" content="Storage As Log"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:image" content="https://og-image-korean.vercel.app/Log-structured%20File%20System%20(LFS).png?theme=dark&amp;md=1&amp;fontSize=125px&amp;images=https%3A%2F%2Fmorethan-log.vercel.app%2Flogo-for-dark-bg.svg"/><meta property="article:published_time" content="2023-01-14T00:00:00.000Z"/><meta property="article:author" content="zishen wen"/><meta name="next-head-count" content="18"/><link rel="preload" as="font" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard-dynamic-subset.css"/><link rel="icon" href="/favicon.ico"/><link rel="apple-touch-icon" sizes="192x192" href="/apple-touch-icon.png"/><link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/feed"/><meta name="theme-color" content="#f1f3f5"/><link rel="preload" href="/_next/static/css/982167d46c9ed228.css" as="style"/><link rel="stylesheet" href="/_next/static/css/982167d46c9ed228.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-d6131c6fa336f8bc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-8d7da0c634fdd74b.js" defer=""></script><script src="/_next/static/chunks/0f4ba5df-9e9406a0dcd1e2b0.js" defer=""></script><script src="/_next/static/chunks/b5f2ed29-08db60af0c3043ba.js" defer=""></script><script src="/_next/static/chunks/167-23d354cda8f8d7da.js" defer=""></script><script src="/_next/static/chunks/605-f1193c6e2a8284ad.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bslug%5D-e1de9cc6741e3d00.js" defer=""></script><script src="/_next/static/8opMz6MOLcCZ8Eu3Yf9uw/_buildManifest.js" defer=""></script><script src="/_next/static/8opMz6MOLcCZ8Eu3Yf9uw/_ssgManifest.js" defer=""></script><script src="/_next/static/8opMz6MOLcCZ8Eu3Yf9uw/_middlewareManifest.js" defer=""></script></head><body class="bg-day dark:bg-night"><div id="__next" data-reactroot=""><div><div class="wrapper"><div class="sticky-nav m-auto w-full h-6 flex flex-row justify-between items-center mb-2 md:mb-6 py-8 bg-opacity-60 max-w-6xl px-4 false" id="sticky-nav"><a aria-label="zwen&#x27;s random stuff" href="/"><div class="flex items-center"><div class="ml-2 text-black dark:text-white header-name">zwen&#x27;s random stuff</div></div></a><div class="flex gap-3 items-center"><div class="flex-shrink-0"><ul class="flex flex-row"><li class="block ml-4 text-black dark:text-gray-50 nav"><a href="/about">About</a></li></ul></div></div></div><main class="m-auto flex-grow w-full transition-all max-w-6xl px-4 false false "><div><div class="m-auto max-w-4xl bg-white dark:bg-zinc-700 rounded-3xl py-12 px-6 shadow-md"><article class="m-auto max-w-2xl"><h1 class="font-bold text-3xl text-black dark:text-white">Log-structured File System (LFS)</h1><nav class="mt-6 text-gray-500 dark:text-gray-400"><div class="flex items-center gap-3 mb-3"><div class="flex items-center gap-2"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2724%27%20height=%2724%27/%3e"/></span><img alt="profile_photo" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="rounded-full" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="profile_photo" srcSet="https://s3-us-west-2.amazonaws.com/public.notion-static.com/6c509773-f27d-4c13-875f-0c60b39074bf/headshot_small.jpg?imwidth=32 1x, https://s3-us-west-2.amazonaws.com/public.notion-static.com/6c509773-f27d-4c13-875f-0c60b39074bf/headshot_small.jpg?imwidth=48 2x" src="https://s3-us-west-2.amazonaws.com/public.notion-static.com/6c509773-f27d-4c13-875f-0c60b39074bf/headshot_small.jpg?imwidth=48" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="rounded-full" loading="lazy"/></noscript></span><div class="">zzzz-vincent</div></div><div class="self-stretch w-px my-1 bg-gray-300"></div><div class=" mr-2 md:ml-0">Jan 13, 2023</div></div><div class="flex items-center mb-4"><div class="flex flex-nowrap max-w-full overflow-x-auto article-tags gap-2"><div class="text-xs text-gray-500 font-normal rounded-full bg-gray-200 px-2 py-1 cursor-pointer">Storage System</div></div></div></nav><div class="-mt-4"><main class="notion light-mode notion-page notion-block-debd732fedfa46be9da0c67c2a2a3808"><div class="notion-viewport"></div><div class="notion-collection-row"><div class="notion-collection-row-body"><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M10.889 5.5H3.11v1.556h7.778V5.5zm1.555-4.444h-.777V0H10.11v1.056H3.89V0H2.333v1.056h-.777c-.864 0-1.548.7-1.548 1.555L0 12.5c0 .856.692 1.5 1.556 1.5h10.888C13.3 14 14 13.356 14 12.5V2.611c0-.855-.7-1.555-1.556-1.555zm0 11.444H1.556V3.944h10.888V12.5zM8.556 8.611H3.11v1.556h5.445V8.61z"></path></svg><div class="notion-collection-column-title-body">date</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-date">Jan 14, 2023</span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M7 4.568a.5.5 0 00-.5-.5h-6a.5.5 0 00-.5.5v1.046a.5.5 0 00.5.5h6a.5.5 0 00.5-.5V4.568zM.5 1a.5.5 0 00-.5.5v1.045a.5.5 0 00.5.5h12a.5.5 0 00.5-.5V1.5a.5.5 0 00-.5-.5H.5zM0 8.682a.5.5 0 00.5.5h11a.5.5 0 00.5-.5V7.636a.5.5 0 00-.5-.5H.5a.5.5 0 00-.5.5v1.046zm0 3.068a.5.5 0 00.5.5h9a.5.5 0 00.5-.5v-1.045a.5.5 0 00-.5-.5h-9a.5.5 0 00-.5.5v1.045z"></path></svg><div class="notion-collection-column-title-body">slug</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-text">lfs</span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M9.625 10.847C8.912 10.289 8.121 9.926 7 9.26v-.54a3.33 3.33 0 00.538-.888c.408-.1.774-.498.774-.832 0-.482-.202-.673-.44-.829 0-.015.003-.03.003-.046 0-.711-.438-2.625-2.625-2.625-2.188 0-2.625 1.915-2.625 2.625 0 .017.003.03.003.046-.238.156-.44.347-.44.829 0 .334.366.731.774.833.146.343.326.643.538.886v.541c-1.12.665-1.912 1.028-2.625 1.587C.041 11.498 0 12.469 0 14h10.5c0-1.531-.041-2.502-.875-3.153zm3.5-3.5c-.713-.558-1.504-.921-2.625-1.587v-.54c.212-.244.392-.544.538-.888.408-.1.774-.498.774-.832 0-.482-.202-.673-.44-.829 0-.015.003-.03.003-.046C11.375 1.914 10.937 0 8.75 0 6.562 0 6.125 1.915 6.125 2.625c0 .017.003.03.003.046-.016.012-.03.025-.047.036 1.751.359 2.516 1.841 2.647 3.04.248.262.46.65.46 1.253 0 .603-.417 1.203-1.004 1.515-.057.109-.117.214-.181.315l.437.245c.64.357 1.194.666 1.724 1.081.138.108.256.224.365.343H14c0-1.53-.041-2.5-.875-3.153z"></path></svg><div class="notion-collection-column-title-body">author</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-person"></span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M7 13A6 6 0 107 1a6 6 0 000 12zM3.751 5.323A.2.2 0 013.909 5h6.182a.2.2 0 01.158.323L7.158 9.297a.2.2 0 01-.316 0L3.751 5.323z"></path></svg><div class="notion-collection-column-title-body">status</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-select"><div class="notion-property-select-item notion-item-red">Public</div></span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M4 3a1 1 0 011-1h7a1 1 0 110 2H5a1 1 0 01-1-1zm0 4a1 1 0 011-1h7a1 1 0 110 2H5a1 1 0 01-1-1zm0 4a1 1 0 011-1h7a1 1 0 110 2H5a1 1 0 01-1-1zM2 4a1 1 0 110-2 1 1 0 010 2zm0 4a1 1 0 110-2 1 1 0 010 2zm0 4a1 1 0 110-2 1 1 0 010 2z"></path></svg><div class="notion-collection-column-title-body">tags</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-multi_select"><div class="notion-property-multi_select-item notion-item-red">Storage System</div></span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M7 4.568a.5.5 0 00-.5-.5h-6a.5.5 0 00-.5.5v1.046a.5.5 0 00.5.5h6a.5.5 0 00.5-.5V4.568zM.5 1a.5.5 0 00-.5.5v1.045a.5.5 0 00.5.5h12a.5.5 0 00.5-.5V1.5a.5.5 0 00-.5-.5H.5zM0 8.682a.5.5 0 00.5.5h11a.5.5 0 00.5-.5V7.636a.5.5 0 00-.5-.5H.5a.5.5 0 00-.5.5v1.046zm0 3.068a.5.5 0 00.5.5h9a.5.5 0 00.5-.5v-1.045a.5.5 0 00-.5-.5h-9a.5.5 0 00-.5.5v1.045z"></path></svg><div class="notion-collection-column-title-body">summary</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-text">Storage As Log</span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M7 13A6 6 0 107 1a6 6 0 000 12zM3.751 5.323A.2.2 0 013.909 5h6.182a.2.2 0 01.158.323L7.158 9.297a.2.2 0 01-.316 0L3.751 5.323z"></path></svg><div class="notion-collection-column-title-body">type</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-select"><div class="notion-property-select-item notion-item-purple">Post</div></span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M5.946 14a4.975 4.975 0 01-3.497-1.415A4.731 4.731 0 011 9.174c0-1.288.515-2.5 1.449-3.41L7.456.986c1.345-1.313 3.722-1.318 5.08.007a3.453 3.453 0 010 4.961L8.03 10.241c-.867.847-2.293.848-3.17-.006a2.158 2.158 0 010-3.102l1.744-1.701 1.272 1.24-1.744 1.701a.43.43 0 000 .621c.23.223.405.223.636 0l4.503-4.288a1.723 1.723 0 00-.007-2.473c-.68-.663-1.864-.663-2.543 0L3.713 7.011a3.006 3.006 0 00-.915 2.163c0 .82.328 1.591.922 2.17 1.19 1.162 3.262 1.162 4.451 0l2.248-2.192 1.272 1.24-2.248 2.193A4.978 4.978 0 015.946 14z"></path></svg><div class="notion-collection-column-title-body">thumbnail</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-file"></span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M6.986 14c-1.79 0-3.582-.69-4.944-2.068-2.723-2.72-2.723-7.172 0-9.892 2.725-2.72 7.182-2.72 9.906 0A6.972 6.972 0 0114 6.996c0 1.88-.728 3.633-2.052 4.955A7.058 7.058 0 016.986 14zm3.285-6.99v1.645H5.526v-5.47h1.841v3.63h2.904v.194zm1.89-.014c0-1.379-.542-2.67-1.522-3.648-2.006-2.005-5.287-2.007-7.297-.009l-.009.009a5.168 5.168 0 000 7.295c2.01 2.007 5.297 2.007 7.306 0a5.119 5.119 0 001.521-3.647z"></path></svg><div class="notion-collection-column-title-body">updatedAt</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-last_edited_time">Feb 3, 2023 09:43 PM</span></div></div></div></div><div class="notion-callout notion-gray_background_co notion-block-f0aa644a99284187aa8bb040185b9e51"><span class="notion-page-icon" role="img" aria-label="📚">📚</span><div class="notion-callout-text">1.<a target="_blank" rel="noopener noreferrer" class="notion-link" href="https://pages.cs.wisc.edu/~remzi/OSTEP/file-lfs.pdf">OSTEP: Log-structured File Systems</a>, 2.<a target="_blank" rel="noopener noreferrer" class="notion-link" href="https://web.stanford.edu/~ouster/cgi-bin/papers/lfs.pdf">The Design and Implementation of a Log-Structured File System</a></div></div><h4 class="notion-h notion-h3 notion-h-indent-0 notion-block-ceeba041cb2a4fa7b35758f6c4f1baaa" data-id="ceeba041cb2a4fa7b35758f6c4f1baaa"><span><div id="ceeba041cb2a4fa7b35758f6c4f1baaa" class="notion-header-anchor"></div><a class="notion-hash-link" href="#ceeba041cb2a4fa7b35758f6c4f1baaa" title="Motivation"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">Motivation</span></span></h4><div class="notion-text notion-block-ba80aa7527b34a1e8fb14574f0ce4458">For other File Systems (FFS)</div><ul class="notion-list notion-list-disc notion-block-f7ce72851d3a4fca97d7f54f3e0c0829"><li><b>System memories are growing</b>: As memory gets bigger, more data can be cached in memory. As more data is cached, disk traffic increasingly consists of writes, as reads are serviced by the cache. <span class="notion-red">File system performance is largely determined by its write performance</span></li></ul><ul class="notion-list notion-list-disc notion-block-92ad5f0acebd4dec95f3de261e7b6a24"><li>L<b>arge gap between random I/O performance and sequential I/O performance</b>: data transfer increase very fast, while mechanical cost (rotation) decreased slowly. <span class="notion-red">Thus, if you are able to use disks in a sequential manner, you gain a sizeable performance advantage over approaches that cause seeks and rotations</span></li></ul><ul class="notion-list notion-list-disc notion-block-3f92d3aaa2494c5ab984c86508ad6b4f"><li><b>Existing file systems perform poorly on many common workloads</b>: For example, FFS would perform a large number of writes to create a new file of size one block: one for a new inode, one to update the inode bitmap, one to the directory data block that the file is in, one to the directory inode to update it, one to the new data block that is a part of the new file, and one to the data bitmap to mark the data block as allocated. Thus, although FFS places all of these blocks within the same block group, <span class="notion-red">FFS incurs many short seeks and subsequent rotational delays and thus performance falls far short of peak sequential bandwidth</span>.</li></ul><ul class="notion-list notion-list-disc notion-block-37c19111814444529c6e2af3603354c5"><li><b>File systems are not RAID-aware</b>: For example, both RAID-4 and RAID-5 have the small-write problem where a logical write to a single block causes 4 physical I/Os to take place. Existing file systems do not try to avoid this worst-case RAID writing behavior</li></ul><div class="notion-text notion-block-0706e7148476414b93ec080f3cda5b19">An ideal file system would thus focus on write performance, and try to make use of the sequential bandwidth of the disk. Further, it would perform well on common workloads that not only write out data but also update on-disk metadata structures frequently. Finally, it would work well on RAIDs as well as single disks.</div><h4 class="notion-h notion-h3 notion-h-indent-0 notion-block-dd32611e7d4f485aac52c95bb20fdcb4" data-id="dd32611e7d4f485aac52c95bb20fdcb4"><span><div id="dd32611e7d4f485aac52c95bb20fdcb4" class="notion-header-anchor"></div><a class="notion-hash-link" href="#dd32611e7d4f485aac52c95bb20fdcb4" title="Writing To Disk Sequentially"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">Writing To Disk Sequentially</span></span></h4><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-d98b88ac7f3e406fba395ec723b33abc"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:384px;max-width:100%;flex-direction:column"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fs3.us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F005620bc-4370-47ec-a44b-518e73bd0a2e%2FUntitled.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45EIPT3X45%252F20230205%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20230205T233244Z%26X-Amz-Expires%3D86400%26X-Amz-Signature%3Dc1c1fa77eb1dcabc50bf575fe821a12851e0e1bc9accc6f6ce19d1e253d58245%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject?table=block&amp;id=d98b88ac-7f3e-406f-ba39-5ec723b33abc&amp;cache=v2" alt="notion image" loading="lazy" decoding="async"/></div></figure><ul class="notion-list notion-list-disc notion-block-b056a936569046dd9204c59fa7beb507"><li>LFS writs all updates (such as data blocks, inodes, etc.) to the disk sequentially</li></ul><ul class="notion-list notion-list-disc notion-block-daab4b24504c4053af5db52a6419348b"><li>eg. Write a data block <code class="notion-inline-code">D</code>, we write both <code class="notion-inline-code">D</code> and its inode <code class="notion-inline-code">I</code></li></ul><ul class="notion-list notion-list-disc notion-block-0db4e05b6258436e83963285aa7f672d"><li>This is called <b>shadow paging/copy-on-write</b>: Instead of overwriting files in places, writes to an unused portion of the disk, and then later reclaims that old space through cleaning</li></ul><h4 class="notion-h notion-h3 notion-h-indent-0 notion-block-1c4fead70c884eda9c2577e5afd910aa" data-id="1c4fead70c884eda9c2577e5afd910aa"><span><div id="1c4fead70c884eda9c2577e5afd910aa" class="notion-header-anchor"></div><a class="notion-hash-link" href="#1c4fead70c884eda9c2577e5afd910aa" title="Writing Sequentially And Effectively"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">Writing Sequentially And Effectively</span></span></h4><ul class="notion-list notion-list-disc notion-block-c34221e5546b41f7a62c1aaaa64f4655"><li><b>Problem</b>: writing to disk sequentially is not (alone) enough to guarantee efficient writes</li><ul class="notion-list notion-list-disc notion-block-c34221e5546b41f7a62c1aaaa64f4655"><li>For example, imagine if we wrote a single block to address A, at time T. We then wait a little while, and write to the disk at address A + 1 (the next block address in sequential order), but at time T + δ. In-between the first and second writes, unfortunately, <b>the disk has rotated</b>; when you issue the second write, it will thus wait for most of a rotation before being committed.</li></ul></ul><ul class="notion-list notion-list-disc notion-block-070a1a48a41849beb15d30eb81b47bd2"><li><b>Solution</b>: <b>write buffering </b>collects small writes to a contiguous writes (or one large write)</li><ul class="notion-list notion-list-disc notion-block-070a1a48a41849beb15d30eb81b47bd2"><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-c2f307f47574433ebd38d8eaba5586e0"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:432px;max-width:100%;flex-direction:column"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fs3.us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F5250324f-8165-4203-bd8f-9f6a55792a67%2FUntitled.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45EIPT3X45%252F20230205%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20230205T233244Z%26X-Amz-Expires%3D86400%26X-Amz-Signature%3D0be9d390633c6527a4e6087c37ac34194c4c2d4ee77d94b3ca0c65c55b4a5abd%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject?table=block&amp;id=c2f307f4-7574-433e-bd38-d8eaba5586e0&amp;cache=v2" alt="notion image" loading="lazy" decoding="async"/></div></figure><li>Before writing to the disk, LFS keeps track of updates in memory; when it has received a sufficient number of updates, it writes them to disk all at once, thus ensuring efficient use of the disk.</li></ul></ul><ul class="notion-list notion-list-disc notion-block-9768ac894a234d97b81ac6a9aaead936"><li><b>Segment</b>: the large chunk of updates LFS writes at one time</li></ul><h4 class="notion-h notion-h3 notion-h-indent-0 notion-block-10c1a62d11d04ff58ee5a77a76e965b4" data-id="10c1a62d11d04ff58ee5a77a76e965b4"><span><div id="10c1a62d11d04ff58ee5a77a76e965b4" class="notion-header-anchor"></div><a class="notion-hash-link" href="#10c1a62d11d04ff58ee5a77a76e965b4" title="How Much to Buffer"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">How Much to Buffer</span></span></h4><ul class="notion-list notion-list-disc notion-block-98f7aebaa65f4a01b6e1acfa45d21a80"><li>assume positioning (i.e., rotation and seek overheads) time is <span role="button" tabindex="0" class="notion-equation notion-equation-inline"><span></span></span> seconds, disk transfer rate is <span role="button" tabindex="0" class="notion-equation notion-equation-inline"><span></span></span> MB/s, total data to write is <span role="button" tabindex="0" class="notion-equation notion-equation-inline"><span></span></span></li></ul><ul class="notion-list notion-list-disc notion-block-0eaf6de53b5b4783ade8c322d50715ab"><li>Time of write</li><ul class="notion-list notion-list-disc notion-block-0eaf6de53b5b4783ade8c322d50715ab"><span role="button" tabindex="0" class="notion-equation notion-equation-block notion-block-073164226d4244e0b710662228b50b2b"><div></div></span></ul></ul><ul class="notion-list notion-list-disc notion-block-8f02bb4bc5fe43e1b345f83d25fb76ad"><li>Effective rate of writing</li><ul class="notion-list notion-list-disc notion-block-8f02bb4bc5fe43e1b345f83d25fb76ad"><span role="button" tabindex="0" class="notion-equation notion-equation-block notion-block-c4bc23f298884c1e8bda0e5c9c6be773"><div></div></span></ul></ul><ul class="notion-list notion-list-disc notion-block-bd7d8755ad3a40ba9e3c179ebd0f93ed"><li>If we want effective rate to be some fraction <span role="button" tabindex="0" class="notion-equation notion-equation-inline"><span></span></span> (0 to 1) of the <span role="button" tabindex="0" class="notion-equation notion-equation-inline"><span></span></span>, then:</li><ul class="notion-list notion-list-disc notion-block-bd7d8755ad3a40ba9e3c179ebd0f93ed"><span role="button" tabindex="0" class="notion-equation notion-equation-block notion-block-a27d1db1d1ca4327b087656a46419e0c"><div></div></span><div class="notion-text notion-block-f3a2776177a1441dadbc1dbad4bc8f3a">Then we get our buffer size <span role="button" tabindex="0" class="notion-equation notion-equation-inline"><span></span></span>:</div><span role="button" tabindex="0" class="notion-equation notion-equation-block notion-block-83c9604fa2ad4def99dd9e110feeb92e"><div></div></span><div class="notion-text notion-block-efde58861970464a9697470d5f10d86d">To achieve higher F, a larger D is needed.</div></ul></ul><h4 class="notion-h notion-h3 notion-h-indent-0 notion-block-f92a61eab5e849bea7d5edd51499789d" data-id="f92a61eab5e849bea7d5edd51499789d"><span><div id="f92a61eab5e849bea7d5edd51499789d" class="notion-header-anchor"></div><a class="notion-hash-link" href="#f92a61eab5e849bea7d5edd51499789d" title="Problem: Finding Inodes"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">Problem: Finding Inodes</span></span></h4><ul class="notion-list notion-list-disc notion-block-ded430905ee84f13895e7613aba127d7"><li>in old UNIX file systems:</li><ul class="notion-list notion-list-disc notion-block-ded430905ee84f13895e7613aba127d7"><li>inodes organized as array and saved on disk at fixed location</li><li>given a inode number and start address: calculate the address directly</li></ul></ul><ul class="notion-list notion-list-disc notion-block-a3fd6478218148188b6567a454096e55"><li>in FFS:</li><ul class="notion-list notion-list-disc notion-block-a3fd6478218148188b6567a454096e55"><li>FFS splits up the inode table into chunks and places a group of inodes within each cylinder group</li><li>must know how big each chunk of inodes is and the start addresses of each → then calculate address</li></ul></ul><ul class="notion-list notion-list-disc notion-block-9710e58656254be7876b17db560a2395"><li>in LFS: inodes are scatter</li></ul><h4 class="notion-h notion-h3 notion-h-indent-0 notion-block-51572cfde4e24212857d412bd902e18e" data-id="51572cfde4e24212857d412bd902e18e"><span><div id="51572cfde4e24212857d412bd902e18e" class="notion-header-anchor"></div><a class="notion-hash-link" href="#51572cfde4e24212857d412bd902e18e" title="Solution: The Inode Map"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">Solution: The Inode Map</span></span></h4><ul class="notion-list notion-list-disc notion-block-6e8d9ff693b64240ae75f51f49157082"><li><b>inode map (imap)</b>: inode numbers to the inodes</li><ul class="notion-list notion-list-disc notion-block-6e8d9ff693b64240ae75f51f49157082"><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-904b12915dc54527a310f3100909508a"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:384px;max-width:100%;flex-direction:column"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fs3.us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F63cf8be1-b82c-4f9a-9e3b-649027b5977c%2FUntitled.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45EIPT3X45%252F20230205%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20230205T233244Z%26X-Amz-Expires%3D86400%26X-Amz-Signature%3Dd73fddb05104a917c9793056b1e3d8524d2bfad8f8805034e489b5d2ceeb86d7%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject?table=block&amp;id=904b1291-5dc5-4527-a310-f3100909508a&amp;cache=v2" alt="notion image" loading="lazy" decoding="async"/></div></figure><li>a simple array, 4 bytes per entry</li><li>any time an inode is written to disk, the imap is updated with its new location</li><li>persistent store</li><li>stores at the tail: when appending a data block to a file k, LFS actually writes the new data block, its inode, and a piece of the inode map all together onto the disk</li></ul></ul><h4 class="notion-h notion-h3 notion-h-indent-0 notion-block-2fed4dc9be124e1db9ea6854f69a07cc" data-id="2fed4dc9be124e1db9ea6854f69a07cc"><span><div id="2fed4dc9be124e1db9ea6854f69a07cc" class="notion-header-anchor"></div><a class="notion-hash-link" href="#2fed4dc9be124e1db9ea6854f69a07cc" title="The Checkpoint Region (CR)"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">The Checkpoint Region (CR)</span></span></h4><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-750fd85d945444d59423f2d6f8d778c0"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:384px;max-width:100%;flex-direction:column"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fs3.us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F1b8b6ada-aa48-4c24-801b-c7656aac6aa8%2FUntitled.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45EIPT3X45%252F20230205%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20230205T233244Z%26X-Amz-Expires%3D86400%26X-Amz-Signature%3D3b793ac57135682374d238cad1b6abb13aa05a52744c7d9006f728937a0cc987%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject?table=block&amp;id=750fd85d-9454-44d5-9423-f2d6f8d778c0&amp;cache=v2" alt="notion image" loading="lazy" decoding="async"/></div></figure><ul class="notion-list notion-list-disc notion-block-73d3ddf61ea34699be2153a637485f11"><li>a fixed place on disk, contains pointers to (i.e., addresses of) the latest pieces of the inode map</li></ul><ul class="notion-list notion-list-disc notion-block-f5fb9972ce3a4c8db9b4946b7ab22753"><li>to find inode map pieces → read CR first</li></ul><ul class="notion-list notion-list-disc notion-block-6fd026859c9b486ba4dea0a65d452633"><li>only update periodically (~30 seconds), so the performance is not going to be harmed a lot</li></ul><h4 class="notion-h notion-h3 notion-h-indent-0 notion-block-5637549ba57c45fdaeb84fae29c19293" data-id="5637549ba57c45fdaeb84fae29c19293"><span><div id="5637549ba57c45fdaeb84fae29c19293" class="notion-header-anchor"></div><a class="notion-hash-link" href="#5637549ba57c45fdaeb84fae29c19293" title="Reading a File"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">Reading a File</span></span></h4><ol start="1" class="notion-list notion-list-numbered notion-block-9813c77228bc49f7bc828c82f366ae70"><li>assume we have noting in memeory</li></ol><ol start="2" class="notion-list notion-list-numbered notion-block-5e80512ddb364f43892c4a41aa4eb426"><li>read checkpoint region</li></ol><ol start="3" class="notion-list notion-list-numbered notion-block-f19d72bb42424ce48d16c4ca1424061c"><li>The checkpoint region contains pointers (i.e., disk addresses) to the entire inode map</li></ol><ol start="4" class="notion-list notion-list-numbered notion-block-8a06fa09581643ba81a903455f8a38ef"><li>reads in the entire inode map and caches it in memory</li></ol><ol start="5" class="notion-list notion-list-numbered notion-block-136eeeaded1f44c1a5cc4b2978efa3fc"><li>when given an inode number of a file</li></ol><ol start="6" class="notion-list notion-list-numbered notion-block-71475ac7f4a44cf29540f71d6c346bf5"><li>looks up the inode-number to inode-diskaddress mapping in the imap</li></ol><ol start="7" class="notion-list notion-list-numbered notion-block-19e5733e50d546a8a3ae6a97f5d7ffdb"><li>reads in the most recent version of the inode</li></ol><ol start="8" class="notion-list notion-list-numbered notion-block-9e55a7437a054ebb9c2e52a8b6f0ca38"><li>read data blocks</li></ol><div class="notion-text notion-block-9021a51c0ba743a7a8b7b78642955e02"><b>LFS should perform the same number of I/Os as a typical file system when reading a file from disk</b>; the entire imap is cached and thus the extra work LFS does during a read is to look up the inode’s address in the imap.</div><h4 class="notion-h notion-h3 notion-h-indent-0 notion-block-54da1d295d3c48df8fddc2483e5aab1e" data-id="54da1d295d3c48df8fddc2483e5aab1e"><span><div id="54da1d295d3c48df8fddc2483e5aab1e" class="notion-header-anchor"></div><a class="notion-hash-link" href="#54da1d295d3c48df8fddc2483e5aab1e" title="Directory"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">Directory</span></span></h4><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-47f8f04c83c54ddca1ba8bc34357102b"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:384px;max-width:100%;flex-direction:column"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fs3.us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Ff08a4e0e-6d13-4836-bca3-f6d408d8f641%2FUntitled.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45EIPT3X45%252F20230205%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20230205T233244Z%26X-Amz-Expires%3D86400%26X-Amz-Signature%3D41816097bd1329beccfb1c897e6abd73f2a3d0f6a101d6ecef1b35ca8a49ee21%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject?table=block&amp;id=47f8f04c-83c5-4ddc-a1ba-8bc34357102b&amp;cache=v2" alt="notion image" loading="lazy" decoding="async"/></div></figure><ul class="notion-list notion-list-disc notion-block-f173cae56b52447ab8c527e4b408e933"><li>inode map contains the information for the location of both the directory file <code class="notion-inline-code">dir</code> as well as the newly-created file <code class="notion-inline-code">f</code></li></ul><ul class="notion-list notion-list-disc notion-block-acd1301f5fd54feaa9f551ec0350c0b7"><li>Thus, when accessing file <code class="notion-inline-code">foo</code> (with inode number <code class="notion-inline-code">k</code>), you would first look in the inode map (usually cached in memory) to find the location of the inode of directory <code class="notion-inline-code">dir</code> (A3);</li></ul><ul class="notion-list notion-list-disc notion-block-4abfc329b25e4109858dda0a9c535563"><li>Then read the directory inode, which gives you the location of the directory data (A2)</li></ul><ul class="notion-list notion-list-disc notion-block-07fa53acab51412090dd2c6698e64539"><li>reading this data block gives you the name-to-inode-number mapping of <code class="notion-inline-code">(foo, k)</code></li></ul><ul class="notion-list notion-list-disc notion-block-2264df27b277468a8e606ca9afd0aaf2"><li>You then consult the inode map again to find the location of inode number <code class="notion-inline-code">k</code></li></ul><ul class="notion-list notion-list-disc notion-block-2d5ff761a99d457aa5e0ddd22cd4d6f7"><li>finally read the desired data block at address A0</li></ul><h4 class="notion-h notion-h3 notion-h-indent-0 notion-block-ae1ff941fb3f443fbae336ad36354272" data-id="ae1ff941fb3f443fbae336ad36354272"><span><div id="ae1ff941fb3f443fbae336ad36354272" class="notion-header-anchor"></div><a class="notion-hash-link" href="#ae1ff941fb3f443fbae336ad36354272" title="Garbage Collection"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">Garbage Collection</span></span></h4><ul class="notion-list notion-list-disc notion-block-7c1f9802f70a4470a81bb47f9c9c7b98"><li>Problems: while writing latest version of a file to new location, old versions (garbage) of file structures scattered throughout the disk.</li><ul class="notion-list notion-list-disc notion-block-7c1f9802f70a4470a81bb47f9c9c7b98"><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-51963fd6e0b943ccb1bf5c59a6896de4"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:384px;max-width:100%;flex-direction:column"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fs3.us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F7cdab430-184a-45c7-9611-d36aafb9ffd8%2FUntitled.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45EIPT3X45%252F20230205%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20230205T233244Z%26X-Amz-Expires%3D86400%26X-Amz-Signature%3Dd78de25ee6c724e5fde7203681ee2b4fa6e28e9f7b2fb3c75a66be4b6d44c9a6%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject?table=block&amp;id=51963fd6-e0b9-43cc-b1bf-5c59a6896de4&amp;cache=v2" alt="notion image" loading="lazy" decoding="async"/></div></figure></ul></ul><ul class="notion-list notion-list-disc notion-block-eb91d502f67e451a8995a2e11174454a"><li>after a new file written, the old version becomes garbage</li></ul><ul class="notion-list notion-list-disc notion-block-ac780bf1d858403fa984529c37eb96de"><li><b>Approach 1 versioning file system</b> (not in LFS): One could keep those older versions around and allow users to restore old file versions (for example, when they accidentally overwrite or delete a file, it could be quite handy to do so)</li></ul><ul class="notion-list notion-list-disc notion-block-0554546147a84d5a9c3344de1188eb74"><li><b>Approach 2 garbage collection</b>: periodically find these old dead versions of file data, inodes, and other structures, and clean them</li></ul><ul class="notion-list notion-list-disc notion-block-4f0c6ad0282c4b91b3e4b73fa16c54de"><li><b>Holes</b>: free blocks after garbage collection → harm to performance</li></ul><ul class="notion-list notion-list-disc notion-block-517038c81e424370bf4c572886d35688"><li><b>segment-by-segment clean</b>:</li><ul class="notion-list notion-list-disc notion-block-517038c81e424370bf4c572886d35688"><li>Periodically, the LFS cleaner reads in a number of old (partially-used) segments</li><li>determines which blocks are live within these segments, and then write out a new set of segments with just the live blocks within them (a process of compact)</li><li>freeing up the old ones for writing</li><li>two important policies: determining liveness, clean schedule</li></ul></ul><h4 class="notion-h notion-h3 notion-h-indent-0 notion-block-d76ea078ca924ffb85762597d5fb5c10" data-id="d76ea078ca924ffb85762597d5fb5c10"><span><div id="d76ea078ca924ffb85762597d5fb5c10" class="notion-header-anchor"></div><a class="notion-hash-link" href="#d76ea078ca924ffb85762597d5fb5c10" title="Determining Block Liveness"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">Determining Block Liveness</span></span></h4><ul class="notion-list notion-list-disc notion-block-7a3b9d8c2548406fa3071b517645836a"><li>Given a data block D within an on disk segment S, LFS must be able to determine whether D is live</li></ul><ul class="notion-list notion-list-disc notion-block-e372a48cde774d17b804f77ec6c79f27"><li><b>segment summary block</b>: for each data block D, its inode number (which file it belongs to) and its offset (which block of the file this is)</li><ul class="notion-list notion-list-disc notion-block-e372a48cde774d17b804f77ec6c79f27"><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-db142080d9024ad8b97049564b41ffd2"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:384px;max-width:100%;flex-direction:column"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fs3.us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F0b42f013-7742-428f-aa7f-04dd9aa85824%2FUntitled.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45EIPT3X45%252F20230205%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20230205T233244Z%26X-Amz-Expires%3D86400%26X-Amz-Signature%3Df7bef2b9e70a89d3a5275d1ebe268beb6820708f3bfcf770aece122380924cf8%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject?table=block&amp;id=db142080-d902-4ad8-b970-49564b41ffd2&amp;cache=v2" alt="notion image" loading="lazy" decoding="async"/></div></figure><ol start="1" class="notion-list notion-list-numbered notion-block-9aca90647842428bb0bb2c2495793244"><li>For a block D located on disk at address A, look in the segment summary block and find its inode number N and offset T.</li></ol><ol start="2" class="notion-list notion-list-numbered notion-block-9595d5a209c7427a8575f01f4b498270"><li>look in the imap to find where N lives and read N from disk
(perhaps it is already in memory, which is even better).</li></ol><ol start="3" class="notion-list notion-list-numbered notion-block-69f520ec80384b2c9cdbf4f36cc5c024"><li>using the offset T, look in the inode (or some indirect block) to see where the inode thinks the Tth block of this file is on disk.</li></ol><ol start="4" class="notion-list notion-list-numbered notion-block-aa12c0fddfb04500a6c2055e2c466946"><li><b>if it points exactly to disk address A, LFS can conclude that the block D is live</b>. If it points anywhere else, LFS can conclude that D is not in use (i.e., it is dead) and thus know that this version is no longer needed</li></ol><pre class="notion-code language-c++"><code class="language-c++"><span class="token punctuation">(</span><span class="token constant">N</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">=</span> SegmentSummary<span class="token punctuation">[</span><span class="token constant">A</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
inode <span class="token operator">=</span> <span class="token function">Read</span><span class="token punctuation">(</span>imap<span class="token punctuation">[</span><span class="token constant">N</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>inode<span class="token punctuation">[</span><span class="token constant">T</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token constant">A</span><span class="token punctuation">)</span>
<span class="token comment">// block D is alive</span>
<span class="token keyword">else</span>
<span class="token comment">// block D is garbage</span></code></pre></ul></ul><ul class="notion-list notion-list-disc notion-block-0cda2b335eb84e909daf7db1a495eb95"><li><b>version number</b>: when a file is truncated or deleted, LFS increases its <b>version number</b> and records the new version number in the imap. By also recording the version number in the on-disk segment, LFS can short circuit the longer check described above simply by comparing the on-disk version number with a version number in the imap, thus avoiding extra reads.</li></ul><h4 class="notion-h notion-h3 notion-h-indent-0 notion-block-a7bc7085b3da42dbad304a6ff1b8137b" data-id="a7bc7085b3da42dbad304a6ff1b8137b"><span><div id="a7bc7085b3da42dbad304a6ff1b8137b" class="notion-header-anchor"></div><a class="notion-hash-link" href="#a7bc7085b3da42dbad304a6ff1b8137b" title="Which Blocks To Clean, And When?"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">Which Blocks To Clean, And When?</span></span></h4><ul class="notion-list notion-list-disc notion-block-87a21fd3c783473baa61c11ef148f494"><li><b>When</b>: Either periodically, during <b>idle time</b>, or when you have to because the disk is <b>full</b>.</li></ul><ul class="notion-list notion-list-disc notion-block-d5b5dd61ede148f38c912736cea777ff"><li><b>Which</b>: <em>Hot</em> and <em>Cold</em> segment</li><ul class="notion-list notion-list-disc notion-block-d5b5dd61ede148f38c912736cea777ff"><li>A hot segment is one in which the contents are being frequently over-written; thus, for such a segment, the best policy is to wait a long time before cleaning it, as more and more blocks are getting over-written (in new segments) and thus being freed for use.</li><li>A cold segment, in contrast, may have a few dead blocks but the rest of its contents are relatively stable.</li></ul></ul><h4 class="notion-h notion-h3 notion-h-indent-0 notion-block-d59f5d048d234a9bb6048356d0a8ee8f" data-id="d59f5d048d234a9bb6048356d0a8ee8f"><span><div id="d59f5d048d234a9bb6048356d0a8ee8f" class="notion-header-anchor"></div><a class="notion-hash-link" href="#d59f5d048d234a9bb6048356d0a8ee8f" title="Crash Recovery And The Log"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">Crash Recovery And The Log</span></span></h4><ul class="notion-list notion-list-disc notion-block-3511f076d5754ffa8807f65400f44fc8"><li>Normal operation: LFS buffers writes in a segment, and then (when the segment is full, or when some amount of time has elapsed), writes the segment to disk. LFS organizes these writes in a <b>log</b><span style="padding:0.5em"></span></li></ul><ul class="notion-list notion-list-disc notion-block-c71a9615c41c45d3b9fe067568d82eb3"><li>Two possible crashes: <b>write to CR</b> and <b>write to segment</b></li></ul><ul class="notion-list notion-list-disc notion-block-8257df10916c40eebad5709186bcfef8"><li><b>atomic CR update</b>: LFS actually keeps two CRs, one at either end of the disk, and writes to them alternately, with protocol:</li><ul class="notion-list notion-list-disc notion-block-8257df10916c40eebad5709186bcfef8"><ol start="1" class="notion-list notion-list-numbered notion-block-03f20658fb6d4633b6388c7180452dee"><li>writes out a header (with timestamp)</li></ol><ol start="2" class="notion-list notion-list-numbered notion-block-95c058908a054dd1b0800b35398fa361"><li>the body of the CR</li></ol><ol start="3" class="notion-list notion-list-numbered notion-block-e5edc16729804f2584cf1025ef6ad447"><li>one last block (also with a timestamp)</li></ol><ol start="4" class="notion-list notion-list-numbered notion-block-40c3505542114859a36fec599c0bc61e"><li>If the system crashes during a CR update, LFS can detect this by seeing an <b>inconsistent pair of timestamps</b></li></ol><ol start="5" class="notion-list notion-list-numbered notion-block-dc72fa4ee3324ab78a27716499bf55fe"><li>always choose to use the most recent CR with consistent timestamp</li></ol></ul></ul><ul class="notion-list notion-list-disc notion-block-3af48d274d244f50a888fde1f9a66063"><li><b>roll forward</b>: start with the last checkpoint region, find the end of the log (which is included in the CR), and then use that to read through the next segments and see if there are any valid updates within it</li><ul class="notion-list notion-list-disc notion-block-3af48d274d244f50a888fde1f9a66063"><li>If there are, LFS updates the file system accordingly and thus recovers much of the data and metadata written since the last checkpoint.</li></ul></ul></main></div><div class="flex justify-between font-medium text-gray-500 dark:text-gray-400"><a><button class="mt-2 cursor-pointer hover:text-black dark:hover:text-gray-100">← Back</button></a><a><button class="mt-2 cursor-pointer hover:text-black dark:hover:text-gray-100">↑ Top</button></a></div></article></div></div></main></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"id":"debd732f-edfa-46be-9da0-c67c2a2a3808","date":{"start_date":"2023-01-14"},"type":["Post"],"slug":"lfs","tags":["Storage System"],"summary":"Storage As Log","author":[{"id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","name":"zzzz-vincent","profile_photo":"https://s3-us-west-2.amazonaws.com/public.notion-static.com/6c509773-f27d-4c13-875f-0c60b39074bf/headshot_small.jpg"}],"title":"Log-structured File System (LFS)","status":["Public"],"createdTime":"Thu Feb 02 2023 00:26:05 GMT-0800 (Pacific Standard Time)","fullWidth":false},"blockMap":{"block":{"debd732f-edfa-46be-9da0-c67c2a2a3808":{"role":"reader","value":{"id":"debd732f-edfa-46be-9da0-c67c2a2a3808","version":462,"type":"page","properties":{"NX\\Q":[["‣",[["d",{"type":"date","start_date":"2023-01-14"}]]]],"`gQ~":[["Post"]],"d]hq":[["lfs"]],"sD^m":[["Storage System"]],"wz|S":[["Storage As Log"]],"~rC=":[["‣",[["u","8d91eb22-d5ae-4a85-ad77-d8911f5589a4"]]]],"title":[["Log-structured File System (LFS)"]],"f211bdc0-ee00-4186-9a7d-f68c055ec2ee":[["Public"]]},"content":["f0aa644a-9928-4187-aa8b-b040185b9e51","ceeba041-cb2a-4fa7-b357-58f6c4f1baaa","ba80aa75-27b3-4a1e-8fb1-4574f0ce4458","f7ce7285-1d3a-4fca-97d7-f54f3e0c0829","92ad5f0a-cebd-4dec-95f3-de261e7b6a24","3f92d3aa-a249-4c5a-b984-c86508ad6b4f","37c19111-8144-4452-9c6e-2af3603354c5","0706e714-8476-414b-93ec-080f3cda5b19","dd32611e-7d4f-485a-ac52-c95bb20fdcb4","d98b88ac-7f3e-406f-ba39-5ec723b33abc","b056a936-5690-46dd-9204-c59fa7beb507","daab4b24-504c-4053-af5d-b52a6419348b","0db4e05b-6258-436e-8396-3285aa7f672d","1c4fead7-0c88-4eda-9c25-77e5afd910aa","c34221e5-546b-41f7-a62c-1aaaa64f4655","070a1a48-a418-49be-b15d-30eb81b47bd2","9768ac89-4a23-4d97-b81a-c6a9aaead936","10c1a62d-11d0-4ff5-8ee5-a77a76e965b4","98f7aeba-a65f-4a01-b6e1-acfa45d21a80","0eaf6de5-3b5b-4783-ade8-c322d50715ab","8f02bb4b-c5fe-43e1-b345-f83d25fb76ad","bd7d8755-ad3a-40ba-9e3c-179ebd0f93ed","f92a61ea-b5e8-49be-a7d5-edd51499789d","ded43090-5ee8-4f13-895e-7613aba127d7","a3fd6478-2181-4818-8b65-67a454096e55","9710e586-5625-4be7-876b-17db560a2395","51572cfd-e4e2-4212-857d-412bd902e18e","6e8d9ff6-93b6-4240-ae75-f51f49157082","2fed4dc9-be12-4e1d-b9ea-6854f69a07cc","750fd85d-9454-44d5-9423-f2d6f8d778c0","73d3ddf6-1ea3-4699-be21-53a637485f11","f5fb9972-ce3a-4c8d-b9b4-946b7ab22753","6fd02685-9c9b-486b-a4de-a0a65d452633","5637549b-a57c-45fd-aeb8-4fae29c19293","9813c772-28bc-49f7-bc82-8c82f366ae70","5e80512d-db36-4f43-892c-4a41aa4eb426","f19d72bb-4242-4ce4-8d16-c4ca1424061c","8a06fa09-5816-43ba-81a9-03455f8a38ef","136eeead-ed1f-44c1-a5cc-4b2978efa3fc","71475ac7-f4a4-4cf2-9540-f71d6c346bf5","19e5733e-50d5-46a8-a3ae-6a97f5d7ffdb","9e55a743-7a05-4ebb-9c2e-52a8b6f0ca38","9021a51c-0ba7-43a7-a8b7-b78642955e02","54da1d29-5d3c-48df-8fdd-c2483e5aab1e","47f8f04c-83c5-4ddc-a1ba-8bc34357102b","f173cae5-6b52-447a-b8c5-27e4b408e933","acd1301f-5fd5-4fea-a9f5-51ec0350c0b7","4abfc329-b25e-4109-858d-da0a9c535563","07fa53ac-ab51-4120-90dd-2c6698e64539","2264df27-b277-468a-8e60-6ca9afd0aaf2","2d5ff761-a99d-457a-a5e0-ddd22cd4d6f7","ae1ff941-fb3f-443f-bae3-36ad36354272","7c1f9802-f70a-4470-a81b-b47f9c9c7b98","eb91d502-f67e-451a-8995-a2e11174454a","ac780bf1-d858-403f-a984-529c37eb96de","05545461-47a8-4d5a-9c33-44de1188eb74","4f0c6ad0-282c-4b91-b3e4-b73fa16c54de","517038c8-1e42-4370-bf4c-572886d35688","d76ea078-ca92-4ffb-8576-2597d5fb5c10","7a3b9d8c-2548-406f-a307-1b517645836a","e372a48c-de77-4d17-b804-f77ec6c79f27","0cda2b33-5eb8-4e90-9daf-7db1a495eb95","a7bc7085-b3da-42db-ad30-4a6ff1b8137b","87a21fd3-c783-473b-aa61-c11ef148f494","d5b5dd61-ede1-48f3-8c91-2736cea777ff","d59f5d04-8d23-4a9b-b604-8356d0a8ee8f","3511f076-d575-4ffa-8807-f65400f44fc8","c71a9615-c41c-45d3-b9fe-067568d82eb3","8257df10-916c-40ee-bad5-709186bcfef8","3af48d27-4d24-4f50-a888-fde1f9a66063"],"created_time":1675326365876,"last_edited_time":1675489435003,"parent_id":"57514c87-fdd3-44e3-81d2-4b83518ee9fa","parent_table":"collection","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"a9c51699-1e50-4bea-adcb-5057c5bddc7b":{"role":"reader","value":{"id":"a9c51699-1e50-4bea-adcb-5057c5bddc7b","version":41,"type":"collection_view_page","view_ids":["07450bcb-93f3-4ef8-af09-a6b03629d439","2bdcebad-9bb0-4b80-9a68-88d71dc88dc1"],"collection_id":"57514c87-fdd3-44e3-81d2-4b83518ee9fa","format":{"block_locked":false,"block_locked_by":"2c0e0b01-f59e-4e03-b7b6-7d706eecada3","collection_pointer":{"id":"57514c87-fdd3-44e3-81d2-4b83518ee9fa","table":"collection","spaceId":"a9502724-d7a1-44ec-8237-1b7455afe793"},"copied_from_pointer":{"id":"12c38b5f-459d-4eb9-a759-f92fba6cea36","table":"block","spaceId":"81443245-8ca3-4444-b4b0-d1c233a71a25"}},"permissions":[{"role":"editor","type":"user_permission","user_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4"},{"role":"reader","type":"public_permission","added_timestamp":1674795833030}],"created_time":1674795731761,"last_edited_time":1675587532016,"parent_id":"a9502724-d7a1-44ec-8237-1b7455afe793","parent_table":"space","alive":true,"copied_from":"12c38b5f-459d-4eb9-a759-f92fba6cea36","created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"f0aa644a-9928-4187-aa8b-b040185b9e51":{"role":"reader","value":{"id":"f0aa644a-9928-4187-aa8b-b040185b9e51","version":101,"type":"callout","properties":{"title":[["1."],["OSTEP: Log-structured File Systems",[["a","https://pages.cs.wisc.edu/~remzi/OSTEP/file-lfs.pdf"]]],[", 2."],["The Design and Implementation of a Log-Structured File System",[["a","https://web.stanford.edu/~ouster/cgi-bin/papers/lfs.pdf"]]]]},"format":{"page_icon":"📚","block_color":"gray_background"},"created_time":1675470187822,"last_edited_time":1675489403825,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"ceeba041-cb2a-4fa7-b357-58f6c4f1baaa":{"role":"reader","value":{"id":"ceeba041-cb2a-4fa7-b357-58f6c4f1baaa","version":4,"type":"sub_sub_header","properties":{"title":[["Motivation"]]},"created_time":1675326713184,"last_edited_time":1675470187822,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"ba80aa75-27b3-4a1e-8fb1-4574f0ce4458":{"role":"reader","value":{"id":"ba80aa75-27b3-4a1e-8fb1-4574f0ce4458","version":121,"type":"text","properties":{"title":[["For other File Systems (FFS)"]]},"created_time":1675404763870,"last_edited_time":1675404788132,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"f7ce7285-1d3a-4fca-97d7-f54f3e0c0829":{"role":"reader","value":{"id":"f7ce7285-1d3a-4fca-97d7-f54f3e0c0829","version":44,"type":"bulleted_list","properties":{"title":[["System memories are growing",[["b"]]],[": As memory gets bigger, more data can be cached in memory. As more data is cached, disk traffic increasingly consists of writes, as reads are serviced by the cache. "],["File system performance is largely determined by its write performance",[["h","red"]]]]},"created_time":1675404135134,"last_edited_time":1675404488820,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"92ad5f0a-cebd-4dec-95f3-de261e7b6a24":{"role":"reader","value":{"id":"92ad5f0a-cebd-4dec-95f3-de261e7b6a24","version":227,"type":"bulleted_list","properties":{"title":[["L"],["arge gap between random I/O performance and sequential I/O performance",[["b"]]],[": data transfer increase very fast, while mechanical cost (rotation) decreased slowly. "],["Thus, if you are able to use disks in a sequential manner, you gain a sizeable performance advantage over approaches that cause seeks and rotations",[["h","red"]]]]},"created_time":1675404200256,"last_edited_time":1675404594883,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"3f92d3aa-a249-4c5a-b984-c86508ad6b4f":{"role":"reader","value":{"id":"3f92d3aa-a249-4c5a-b984-c86508ad6b4f","version":86,"type":"bulleted_list","properties":{"title":[["Existing file systems perform poorly on many common workloads",[["b"]]],[": For example, FFS would perform a large number of writes to create a new file of size one block: one for a new inode, one to update the inode bitmap, one to the directory data block that the file is in, one to the directory inode to update it, one to the new data block that is a part of the new file, and one to the data bitmap to mark the data block as allocated. Thus, although FFS places all of these blocks within the same block group, "],["FFS incurs many short seeks and subsequent rotational delays and thus performance falls far short of peak sequential bandwidth",[["h","red"]]],["."]]},"created_time":1675404541909,"last_edited_time":1675404677435,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"37c19111-8144-4452-9c6e-2af3603354c5":{"role":"reader","value":{"id":"37c19111-8144-4452-9c6e-2af3603354c5","version":23,"type":"bulleted_list","properties":{"title":[["File systems are not RAID-aware",[["b"]]],[": For example, both RAID-4 and RAID-5 have the small-write problem where a logical write to a single block causes 4 physical I/Os to take place. Existing file systems do not try to avoid this worst-case RAID writing behavior"]]},"created_time":1675404678144,"last_edited_time":1675404726102,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"0706e714-8476-414b-93ec-080f3cda5b19":{"role":"reader","value":{"id":"0706e714-8476-414b-93ec-080f3cda5b19","version":18,"type":"text","properties":{"title":[["An ideal file system would thus focus on write performance, and try to make use of the sequential bandwidth of the disk. Further, it would perform well on common workloads that not only write out data but also update on-disk metadata structures frequently. Finally, it would work well on RAIDs as well as single disks."]]},"created_time":1675404792217,"last_edited_time":1675404799699,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"dd32611e-7d4f-485a-ac52-c95bb20fdcb4":{"role":"reader","value":{"id":"dd32611e-7d4f-485a-ac52-c95bb20fdcb4","version":18,"type":"sub_sub_header","properties":{"title":[["Writing To Disk Sequentially"]]},"created_time":1675404813700,"last_edited_time":1675404820030,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"d98b88ac-7f3e-406f-ba39-5ec723b33abc":{"role":"reader","value":{"id":"d98b88ac-7f3e-406f-ba39-5ec723b33abc","version":14,"type":"image","properties":{"size":[["9.3KB"]],"title":[["Untitled"]],"source":[["https://s3-us-west-2.amazonaws.com/secure.notion-static.com/005620bc-4370-47ec-a44b-518e73bd0a2e/Untitled.png"]]},"format":{"block_width":384,"display_source":"https://s3-us-west-2.amazonaws.com/secure.notion-static.com/005620bc-4370-47ec-a44b-518e73bd0a2e/Untitled.png","block_full_width":false,"block_page_width":false,"block_aspect_ratio":0.2420091324200913,"block_preserve_scale":true},"created_time":1675404921722,"last_edited_time":1675404926199,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"file_ids":["005620bc-4370-47ec-a44b-518e73bd0a2e"],"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"b056a936-5690-46dd-9204-c59fa7beb507":{"role":"reader","value":{"id":"b056a936-5690-46dd-9204-c59fa7beb507","version":164,"type":"bulleted_list","properties":{"title":[["LFS writs all updates (such as data blocks, inodes, etc.) to the disk sequentially"]]},"created_time":1675404866734,"last_edited_time":1675405003089,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"daab4b24-504c-4053-af5d-b52a6419348b":{"role":"reader","value":{"id":"daab4b24-504c-4053-af5d-b52a6419348b","version":12,"type":"bulleted_list","properties":{"title":[["eg. Write a data block "],["D",[["c"]]],[", we write both "],["D",[["c"]]],[" and its inode "],["I",[["c"]]]]},"created_time":1675404866734,"last_edited_time":1675405005878,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"0db4e05b-6258-436e-8396-3285aa7f672d":{"role":"reader","value":{"id":"0db4e05b-6258-436e-8396-3285aa7f672d","version":39,"type":"bulleted_list","properties":{"title":[["This is called "],["shadow paging/copy-on-write",[["b"]]],[": Instead of overwriting files in places, writes to an unused portion of the disk, and then later reclaims that old space through cleaning"]]},"created_time":1675470139943,"last_edited_time":1675470150465,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"1c4fead7-0c88-4eda-9c25-77e5afd910aa":{"role":"reader","value":{"id":"1c4fead7-0c88-4eda-9c25-77e5afd910aa","version":20,"type":"sub_sub_header","properties":{"title":[["Writing Sequentially And Effectively"]]},"created_time":1675405013189,"last_edited_time":1675405015821,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"c34221e5-546b-41f7-a62c-1aaaa64f4655":{"role":"reader","value":{"id":"c34221e5-546b-41f7-a62c-1aaaa64f4655","version":40,"type":"bulleted_list","properties":{"title":[["Problem",[["b"]]],[": writing to disk sequentially is not (alone) enough to guarantee efficient writes"]]},"content":["3facc6d9-6f1b-416c-b760-22953dc4d881"],"created_time":1675405016768,"last_edited_time":1675405252337,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"3facc6d9-6f1b-416c-b760-22953dc4d881":{"role":"reader","value":{"id":"3facc6d9-6f1b-416c-b760-22953dc4d881","version":34,"type":"bulleted_list","properties":{"title":[["For example, imagine if we wrote a single block to address A, at time T. We then wait a little while, and write to the disk at address A + 1 (the next block address in sequential order), but at time T + δ. In-between the first and second writes, unfortunately, "],["the disk has rotated",[["b"]]],["; when you issue the second write, it will thus wait for most of a rotation before being committed."]]},"created_time":1675405149949,"last_edited_time":1675405247169,"parent_id":"c34221e5-546b-41f7-a62c-1aaaa64f4655","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"070a1a48-a418-49be-b15d-30eb81b47bd2":{"role":"reader","value":{"id":"070a1a48-a418-49be-b15d-30eb81b47bd2","version":164,"type":"bulleted_list","properties":{"title":[["Solution",[["b"]]],[": "],["write buffering ",[["b"]]],["collects small writes to a contiguous writes (or one large write)"]]},"content":["c2f307f4-7574-433e-bd38-d8eaba5586e0","49110f58-0ab7-4ec0-a4df-bdf5b7cd6f42"],"created_time":1675405172966,"last_edited_time":1675405375720,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"c2f307f4-7574-433e-bd38-d8eaba5586e0":{"role":"reader","value":{"id":"c2f307f4-7574-433e-bd38-d8eaba5586e0","version":19,"type":"image","properties":{"size":[["47.4KB"]],"title":[["Untitled"]],"source":[["https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5250324f-8165-4203-bd8f-9f6a55792a67/Untitled.png"]]},"format":{"block_width":432,"display_source":"https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5250324f-8165-4203-bd8f-9f6a55792a67/Untitled.png","block_alignment":"center","block_full_width":false,"block_page_width":false,"block_aspect_ratio":0.27726675427069647,"block_preserve_scale":true},"created_time":1675405369617,"last_edited_time":1675405383388,"parent_id":"070a1a48-a418-49be-b15d-30eb81b47bd2","parent_table":"block","alive":true,"file_ids":["5250324f-8165-4203-bd8f-9f6a55792a67"],"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"49110f58-0ab7-4ec0-a4df-bdf5b7cd6f42":{"role":"reader","value":{"id":"49110f58-0ab7-4ec0-a4df-bdf5b7cd6f42","version":26,"type":"bulleted_list","properties":{"title":[["Before writing to the disk, LFS keeps track of updates in memory; when it has received a sufficient number of updates, it writes them to disk all at once, thus ensuring efficient use of the disk."]]},"created_time":1675405278537,"last_edited_time":1675405375720,"parent_id":"070a1a48-a418-49be-b15d-30eb81b47bd2","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"9768ac89-4a23-4d97-b81a-c6a9aaead936":{"role":"reader","value":{"id":"9768ac89-4a23-4d97-b81a-c6a9aaead936","version":32,"type":"bulleted_list","properties":{"title":[["Segment",[["b"]]],[": the large chunk of updates LFS writes at one time"]]},"created_time":1675405320267,"last_edited_time":1675405390800,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"10c1a62d-11d0-4ff5-8ee5-a77a76e965b4":{"role":"reader","value":{"id":"10c1a62d-11d0-4ff5-8ee5-a77a76e965b4","version":58,"type":"sub_sub_header","properties":{"title":[["How Much to Buffer"]]},"created_time":1675405391326,"last_edited_time":1675405399436,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"98f7aeba-a65f-4a01-b6e1-acfa45d21a80":{"role":"reader","value":{"id":"98f7aeba-a65f-4a01-b6e1-acfa45d21a80","version":259,"type":"bulleted_list","properties":{"title":[["assume positioning (i.e., rotation and seek overheads) time is "],["⁍",[["e","T_{position}"]]],[" seconds, disk transfer rate is "],["⁍",[["e","R_{peak}"]]],[" MB/s, total data to write is "],["⁍",[["e","D"]]]]},"created_time":1675405509889,"last_edited_time":1675405897794,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"0eaf6de5-3b5b-4783-ade8-c322d50715ab":{"role":"reader","value":{"id":"0eaf6de5-3b5b-4783-ade8-c322d50715ab","version":45,"type":"bulleted_list","properties":{"title":[["Time of write"]]},"content":["07316422-6d42-44e0-b710-662228b50b2b"],"created_time":1675405608120,"last_edited_time":1675406764475,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"07316422-6d42-44e0-b710-662228b50b2b":{"role":"reader","value":{"id":"07316422-6d42-44e0-b710-662228b50b2b","version":146,"type":"equation","properties":{"title":[["T_{write} = T_{position} + \\frac{D}{R_{peak}}"]]},"created_time":1675405611680,"last_edited_time":1675406764475,"parent_id":"0eaf6de5-3b5b-4783-ade8-c322d50715ab","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"8f02bb4b-c5fe-43e1-b345-f83d25fb76ad":{"role":"reader","value":{"id":"8f02bb4b-c5fe-43e1-b345-f83d25fb76ad","version":21,"type":"bulleted_list","properties":{"title":[["Effective rate of writing"]]},"content":["c4bc23f2-9888-4c1e-8bda-0e5c9c6be773"],"created_time":1675404950080,"last_edited_time":1675406762006,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"c4bc23f2-9888-4c1e-8bda-0e5c9c6be773":{"role":"reader","value":{"id":"c4bc23f2-9888-4c1e-8bda-0e5c9c6be773","version":120,"type":"equation","properties":{"title":[["R_{effective}=\\frac{D}{T_{write}}=\\frac{D}{T_{position} + \\frac{D}{R_{peak}}}"]]},"created_time":1675405934115,"last_edited_time":1675406762006,"parent_id":"8f02bb4b-c5fe-43e1-b345-f83d25fb76ad","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"bd7d8755-ad3a-40ba-9e3c-179ebd0f93ed":{"role":"reader","value":{"id":"bd7d8755-ad3a-40ba-9e3c-179ebd0f93ed","version":219,"type":"bulleted_list","properties":{"title":[["If we want effective rate to be some fraction "],["⁍",[["e","F"]]],[" (0 to 1) of the "],["⁍",[["e","R_{peak}"]]],[", then:"]]},"content":["a27d1db1-d1ca-4327-b087-656a46419e0c","f3a27761-77a1-441d-adbc-1dbad4bc8f3a","83c9604f-a2ad-4def-99dd-9e110feeb92e","efde5886-1970-464a-9697-470d5f10d86d"],"created_time":1675406053744,"last_edited_time":1675406821243,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"a27d1db1-d1ca-4327-b087-656a46419e0c":{"role":"reader","value":{"id":"a27d1db1-d1ca-4327-b087-656a46419e0c","version":16,"type":"equation","properties":{"title":[["F \\times{R_{effective}} = \\frac{D}{T_{position} + \\frac{D}{R_{peak}}}"]]},"created_time":1675406318257,"last_edited_time":1675406758872,"parent_id":"bd7d8755-ad3a-40ba-9e3c-179ebd0f93ed","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"f3a27761-77a1-441d-adbc-1dbad4bc8f3a":{"role":"reader","value":{"id":"f3a27761-77a1-441d-adbc-1dbad4bc8f3a","version":237,"type":"text","properties":{"title":[["Then we get our buffer size "],["⁍",[["e","D"]]],[":"]]},"created_time":1675406671463,"last_edited_time":1675406780295,"parent_id":"bd7d8755-ad3a-40ba-9e3c-179ebd0f93ed","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"83c9604f-a2ad-4def-99dd-9e110feeb92e":{"role":"reader","value":{"id":"83c9604f-a2ad-4def-99dd-9e110feeb92e","version":126,"type":"equation","properties":{"title":[["D=\\frac{F}{1-F}\\times{R_{peak}}\\times{T_{position}}"]]},"created_time":1675406354714,"last_edited_time":1675406773875,"parent_id":"bd7d8755-ad3a-40ba-9e3c-179ebd0f93ed","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"efde5886-1970-464a-9697-470d5f10d86d":{"role":"reader","value":{"id":"efde5886-1970-464a-9697-470d5f10d86d","version":115,"type":"text","properties":{"title":[["To achieve higher F, a larger D is needed."]]},"created_time":1675406689401,"last_edited_time":1675406803760,"parent_id":"bd7d8755-ad3a-40ba-9e3c-179ebd0f93ed","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"f92a61ea-b5e8-49be-a7d5-edd51499789d":{"role":"reader","value":{"id":"f92a61ea-b5e8-49be-a7d5-edd51499789d","version":73,"type":"sub_sub_header","properties":{"title":[["Problem: Finding Inodes"]]},"created_time":1675406820798,"last_edited_time":1675406836252,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"ded43090-5ee8-4f13-895e-7613aba127d7":{"role":"reader","value":{"id":"ded43090-5ee8-4f13-895e-7613aba127d7","version":111,"type":"bulleted_list","properties":{"title":[["in old UNIX file systems:"]]},"content":["b15609c7-92c5-4f16-aae9-0b199e092c4a","2ef299e9-7d4a-41a4-8e07-1481d5adcc46"],"created_time":1675407144925,"last_edited_time":1675407250932,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"b15609c7-92c5-4f16-aae9-0b199e092c4a":{"role":"reader","value":{"id":"b15609c7-92c5-4f16-aae9-0b199e092c4a","version":134,"type":"bulleted_list","properties":{"title":[["inodes organized as array and saved on disk at fixed location"]]},"created_time":1675407168776,"last_edited_time":1675407198661,"parent_id":"ded43090-5ee8-4f13-895e-7613aba127d7","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"2ef299e9-7d4a-41a4-8e07-1481d5adcc46":{"role":"reader","value":{"id":"2ef299e9-7d4a-41a4-8e07-1481d5adcc46","version":180,"type":"bulleted_list","properties":{"title":[["given a inode number and start address: calculate the address directly"]]},"created_time":1675407199340,"last_edited_time":1675407351960,"parent_id":"ded43090-5ee8-4f13-895e-7613aba127d7","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"a3fd6478-2181-4818-8b65-67a454096e55":{"role":"reader","value":{"id":"a3fd6478-2181-4818-8b65-67a454096e55","version":38,"type":"bulleted_list","properties":{"title":[["in FFS:"]]},"content":["79501de1-1be1-43e2-9422-bb9c4df7546a","a2ed634c-4f6f-4d65-a4ee-6fc37d156273"],"created_time":1675407249993,"last_edited_time":1675407353108,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"79501de1-1be1-43e2-9422-bb9c4df7546a":{"role":"reader","value":{"id":"79501de1-1be1-43e2-9422-bb9c4df7546a","version":14,"type":"bulleted_list","properties":{"title":[["FFS splits up the inode table into chunks and places a group of inodes within each cylinder group"]]},"created_time":1675407263095,"last_edited_time":1675407281999,"parent_id":"a3fd6478-2181-4818-8b65-67a454096e55","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"a2ed634c-4f6f-4d65-a4ee-6fc37d156273":{"role":"reader","value":{"id":"a2ed634c-4f6f-4d65-a4ee-6fc37d156273","version":66,"type":"bulleted_list","properties":{"title":[["must know how big each chunk of inodes is and the start addresses of each → then calculate address"]]},"created_time":1675407286029,"last_edited_time":1675407349642,"parent_id":"a3fd6478-2181-4818-8b65-67a454096e55","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"9710e586-5625-4be7-876b-17db560a2395":{"role":"reader","value":{"id":"9710e586-5625-4be7-876b-17db560a2395","version":64,"type":"bulleted_list","properties":{"title":[["in LFS: inodes are scatter"]]},"created_time":1675407338579,"last_edited_time":1675407367654,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"51572cfd-e4e2-4212-857d-412bd902e18e":{"role":"reader","value":{"id":"51572cfd-e4e2-4212-857d-412bd902e18e","version":44,"type":"sub_sub_header","properties":{"title":[["Solution: The Inode Map"]]},"created_time":1675407369562,"last_edited_time":1675407379439,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"6e8d9ff6-93b6-4240-ae75-f51f49157082":{"role":"reader","value":{"id":"6e8d9ff6-93b6-4240-ae75-f51f49157082","version":61,"type":"bulleted_list","properties":{"title":[["inode map (imap)",[["b"]]],[": inode numbers to the inodes"]]},"content":["904b1291-5dc5-4527-a310-f3100909508a","a017d935-bf18-4fb1-9434-b8f0a566984e","cf1cfcd2-5d33-437b-8137-af8502981585","cb72e06b-6f3c-4e9d-b523-7b9c15efb5ff","9c96b3ed-8a7d-463b-8bc7-0f0a961db6bf"],"created_time":1675407379860,"last_edited_time":1675407906558,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"904b1291-5dc5-4527-a310-f3100909508a":{"role":"reader","value":{"id":"904b1291-5dc5-4527-a310-f3100909508a","version":19,"type":"image","properties":{"size":[["30.3KB"]],"title":[["Untitled"]],"source":[["https://s3-us-west-2.amazonaws.com/secure.notion-static.com/63cf8be1-b82c-4f9a-9e3b-649027b5977c/Untitled.png"]]},"format":{"block_width":384,"display_source":"https://s3-us-west-2.amazonaws.com/secure.notion-static.com/63cf8be1-b82c-4f9a-9e3b-649027b5977c/Untitled.png","block_alignment":"center","block_full_width":false,"block_page_width":false,"block_aspect_ratio":0.27456258411843876,"block_preserve_scale":true},"created_time":1675407846469,"last_edited_time":1675407853241,"parent_id":"6e8d9ff6-93b6-4240-ae75-f51f49157082","parent_table":"block","alive":true,"file_ids":["63cf8be1-b82c-4f9a-9e3b-649027b5977c"],"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"a017d935-bf18-4fb1-9434-b8f0a566984e":{"role":"reader","value":{"id":"a017d935-bf18-4fb1-9434-b8f0a566984e","version":82,"type":"bulleted_list","properties":{"title":[["a simple array, 4 bytes per entry"]]},"created_time":1675407678731,"last_edited_time":1675407718482,"parent_id":"6e8d9ff6-93b6-4240-ae75-f51f49157082","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"cf1cfcd2-5d33-437b-8137-af8502981585":{"role":"reader","value":{"id":"cf1cfcd2-5d33-437b-8137-af8502981585","version":15,"type":"bulleted_list","properties":{"title":[["any time an inode is written to disk, the imap is updated with its new location"]]},"created_time":1675407719515,"last_edited_time":1675407732032,"parent_id":"6e8d9ff6-93b6-4240-ae75-f51f49157082","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"cb72e06b-6f3c-4e9d-b523-7b9c15efb5ff":{"role":"reader","value":{"id":"cb72e06b-6f3c-4e9d-b523-7b9c15efb5ff","version":19,"type":"bulleted_list","properties":{"title":[["persistent store"]]},"created_time":1675407733561,"last_edited_time":1675407742293,"parent_id":"6e8d9ff6-93b6-4240-ae75-f51f49157082","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"9c96b3ed-8a7d-463b-8bc7-0f0a961db6bf":{"role":"reader","value":{"id":"9c96b3ed-8a7d-463b-8bc7-0f0a961db6bf","version":55,"type":"bulleted_list","properties":{"title":[["stores at the tail: when appending a data block to a file k, LFS actually writes the new data block, its inode, and a piece of the inode map all together onto the disk"]]},"created_time":1675407780798,"last_edited_time":1675407871223,"parent_id":"6e8d9ff6-93b6-4240-ae75-f51f49157082","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"2fed4dc9-be12-4e1d-b9ea-6854f69a07cc":{"role":"reader","value":{"id":"2fed4dc9-be12-4e1d-b9ea-6854f69a07cc","version":33,"type":"sub_sub_header","properties":{"title":[["The Checkpoint Region (CR)"]]},"created_time":1675407854412,"last_edited_time":1675408753203,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"750fd85d-9454-44d5-9423-f2d6f8d778c0":{"role":"reader","value":{"id":"750fd85d-9454-44d5-9423-f2d6f8d778c0","version":14,"type":"image","properties":{"size":[["40.1KB"]],"title":[["Untitled"]],"source":[["https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1b8b6ada-aa48-4c24-801b-c7656aac6aa8/Untitled.png"]]},"format":{"block_width":384,"display_source":"https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1b8b6ada-aa48-4c24-801b-c7656aac6aa8/Untitled.png","block_full_width":false,"block_page_width":false,"block_aspect_ratio":0.259946949602122,"block_preserve_scale":true},"created_time":1675408086914,"last_edited_time":1675408726890,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"file_ids":["1b8b6ada-aa48-4c24-801b-c7656aac6aa8"],"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"73d3ddf6-1ea3-4699-be21-53a637485f11":{"role":"reader","value":{"id":"73d3ddf6-1ea3-4699-be21-53a637485f11","version":95,"type":"bulleted_list","properties":{"title":[["a fixed place on disk, contains pointers to (i.e., addresses of) the latest pieces of the inode map"]]},"created_time":1675408728951,"last_edited_time":1675410052899,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"f5fb9972-ce3a-4c8d-b9b4-946b7ab22753":{"role":"reader","value":{"id":"f5fb9972-ce3a-4c8d-b9b4-946b7ab22753","version":94,"type":"bulleted_list","properties":{"title":[["to find inode map pieces → read CR first"]]},"created_time":1675410068888,"last_edited_time":1675410083662,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"6fd02685-9c9b-486b-a4de-a0a65d452633":{"role":"reader","value":{"id":"6fd02685-9c9b-486b-a4de-a0a65d452633","version":209,"type":"bulleted_list","properties":{"title":[["only update periodically (~30 seconds), so the performance is not going to be harmed a lot"]]},"created_time":1675410087580,"last_edited_time":1675410115415,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"5637549b-a57c-45fd-aeb8-4fae29c19293":{"role":"reader","value":{"id":"5637549b-a57c-45fd-aeb8-4fae29c19293","version":94,"type":"sub_sub_header","properties":{"title":[["Reading a File"]]},"created_time":1675410115620,"last_edited_time":1675410143238,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"9813c772-28bc-49f7-bc82-8c82f366ae70":{"role":"reader","value":{"id":"9813c772-28bc-49f7-bc82-8c82f366ae70","version":78,"type":"numbered_list","properties":{"title":[["assume we have noting in memeory"]]},"created_time":1675410141164,"last_edited_time":1675410196013,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"5e80512d-db36-4f43-892c-4a41aa4eb426":{"role":"reader","value":{"id":"5e80512d-db36-4f43-892c-4a41aa4eb426","version":63,"type":"numbered_list","properties":{"title":[["read checkpoint region"]]},"created_time":1675410199181,"last_edited_time":1675410209364,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"f19d72bb-4242-4ce4-8d16-c4ca1424061c":{"role":"reader","value":{"id":"f19d72bb-4242-4ce4-8d16-c4ca1424061c","version":7,"type":"numbered_list","properties":{"title":[["The checkpoint region contains pointers (i.e., disk addresses) to the entire inode map"]]},"created_time":1675410209692,"last_edited_time":1675410219238,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"8a06fa09-5816-43ba-81a9-03455f8a38ef":{"role":"reader","value":{"id":"8a06fa09-5816-43ba-81a9-03455f8a38ef","version":7,"type":"numbered_list","properties":{"title":[["reads in the entire inode map and caches it in memory"]]},"created_time":1675410222639,"last_edited_time":1675410229270,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"136eeead-ed1f-44c1-a5cc-4b2978efa3fc":{"role":"reader","value":{"id":"136eeead-ed1f-44c1-a5cc-4b2978efa3fc","version":11,"type":"numbered_list","properties":{"title":[["when given an inode number of a file"]]},"created_time":1675410230297,"last_edited_time":1675410242428,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"71475ac7-f4a4-4cf2-9540-f71d6c346bf5":{"role":"reader","value":{"id":"71475ac7-f4a4-4cf2-9540-f71d6c346bf5","version":7,"type":"numbered_list","properties":{"title":[["looks up the inode-number to inode-diskaddress mapping in the imap"]]},"created_time":1675410245097,"last_edited_time":1675410252925,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"19e5733e-50d5-46a8-a3ae-6a97f5d7ffdb":{"role":"reader","value":{"id":"19e5733e-50d5-46a8-a3ae-6a97f5d7ffdb","version":11,"type":"numbered_list","properties":{"title":[["reads in the most recent version of the inode"]]},"created_time":1675410253536,"last_edited_time":1675410562929,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"9e55a743-7a05-4ebb-9c2e-52a8b6f0ca38":{"role":"reader","value":{"id":"9e55a743-7a05-4ebb-9c2e-52a8b6f0ca38","version":97,"type":"numbered_list","properties":{"title":[["read data blocks"]]},"created_time":1675410572775,"last_edited_time":1675410603965,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"9021a51c-0ba7-43a7-a8b7-b78642955e02":{"role":"reader","value":{"id":"9021a51c-0ba7-43a7-a8b7-b78642955e02","version":16,"type":"text","properties":{"title":[["LFS should perform the same number of I/Os as a typical file system when reading a file from disk",[["b"]]],["; the entire imap is cached and thus the extra work LFS does during a read is to look up the inode’s address in the imap."]]},"created_time":1675410611016,"last_edited_time":1675410621744,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"54da1d29-5d3c-48df-8fdd-c2483e5aab1e":{"role":"reader","value":{"id":"54da1d29-5d3c-48df-8fdd-c2483e5aab1e","version":34,"type":"sub_sub_header","properties":{"title":[["Directory"]]},"created_time":1675410623369,"last_edited_time":1675410639756,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"47f8f04c-83c5-4ddc-a1ba-8bc34357102b":{"role":"reader","value":{"id":"47f8f04c-83c5-4ddc-a1ba-8bc34357102b","version":14,"type":"image","properties":{"size":[["47.1KB"]],"title":[["Untitled"]],"source":[["https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f08a4e0e-6d13-4836-bca3-f6d408d8f641/Untitled.png"]]},"format":{"block_width":384,"display_source":"https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f08a4e0e-6d13-4836-bca3-f6d408d8f641/Untitled.png","block_full_width":false,"block_page_width":false,"block_aspect_ratio":0.2724795640326976,"block_preserve_scale":true},"created_time":1675414474311,"last_edited_time":1675414480735,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"file_ids":["f08a4e0e-6d13-4836-bca3-f6d408d8f641"],"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"f173cae5-6b52-447a-b8c5-27e4b408e933":{"role":"reader","value":{"id":"f173cae5-6b52-447a-b8c5-27e4b408e933","version":29,"type":"bulleted_list","properties":{"title":[["inode map contains the information for the location of both the directory file "],["dir",[["c"]]],[" as well as the newly-created file "],["f",[["c"]]]]},"created_time":1675414476694,"last_edited_time":1675414858597,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"acd1301f-5fd5-4fea-a9f5-51ec0350c0b7":{"role":"reader","value":{"id":"acd1301f-5fd5-4fea-a9f5-51ec0350c0b7","version":25,"type":"bulleted_list","properties":{"title":[["Thus, when accessing file "],["foo",[["c"]]],[" (with inode number "],["k",[["c"]]],["), you would first look in the inode map (usually cached in memory) to find the location of the inode of directory "],["dir",[["c"]]],[" (A3);"]]},"created_time":1675414839308,"last_edited_time":1675414874160,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"4abfc329-b25e-4109-858d-da0a9c535563":{"role":"reader","value":{"id":"4abfc329-b25e-4109-858d-da0a9c535563","version":19,"type":"bulleted_list","properties":{"title":[["Then read the directory inode, which gives you the location of the directory data (A2)"]]},"created_time":1675414876308,"last_edited_time":1675414890468,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"07fa53ac-ab51-4120-90dd-2c6698e64539":{"role":"reader","value":{"id":"07fa53ac-ab51-4120-90dd-2c6698e64539","version":13,"type":"bulleted_list","properties":{"title":[["reading this data block gives you the name-to-inode-number mapping of "],["(foo, k)",[["c"]]]]},"created_time":1675414913562,"last_edited_time":1675414929762,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"2264df27-b277-468a-8e60-6ca9afd0aaf2":{"role":"reader","value":{"id":"2264df27-b277-468a-8e60-6ca9afd0aaf2","version":13,"type":"bulleted_list","properties":{"title":[["You then consult the inode map again to find the location of inode number "],["k",[["c"]]]]},"created_time":1675414931044,"last_edited_time":1675414952730,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"2d5ff761-a99d-457a-a5e0-ddd22cd4d6f7":{"role":"reader","value":{"id":"2d5ff761-a99d-457a-a5e0-ddd22cd4d6f7","version":11,"type":"bulleted_list","properties":{"title":[["finally read the desired data block at address A0"]]},"created_time":1675414953767,"last_edited_time":1675414963807,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"ae1ff941-fb3f-443f-bae3-36ad36354272":{"role":"reader","value":{"id":"ae1ff941-fb3f-443f-bae3-36ad36354272","version":20,"type":"sub_sub_header","properties":{"title":[["Garbage Collection"]]},"created_time":1675415262729,"last_edited_time":1675415280924,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"7c1f9802-f70a-4470-a81b-b47f9c9c7b98":{"role":"reader","value":{"id":"7c1f9802-f70a-4470-a81b-b47f9c9c7b98","version":178,"type":"bulleted_list","properties":{"title":[["Problems: while writing latest version of a file to new location, old versions (garbage) of file structures scattered throughout the disk."]]},"content":["51963fd6-e0b9-43cc-b1bf-5c59a6896de4"],"created_time":1675461275673,"last_edited_time":1675466521781,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"51963fd6-e0b9-43cc-b1bf-5c59a6896de4":{"role":"reader","value":{"id":"51963fd6-e0b9-43cc-b1bf-5c59a6896de4","version":19,"type":"image","properties":{"size":[["43.5KB"]],"title":[["Untitled"]],"source":[["https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7cdab430-184a-45c7-9611-d36aafb9ffd8/Untitled.png"]]},"format":{"block_width":384,"display_source":"https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7cdab430-184a-45c7-9611-d36aafb9ffd8/Untitled.png","block_alignment":"center","block_full_width":false,"block_page_width":false,"block_aspect_ratio":0.29098360655737704,"block_preserve_scale":true},"created_time":1675466517062,"last_edited_time":1675467972030,"parent_id":"7c1f9802-f70a-4470-a81b-b47f9c9c7b98","parent_table":"block","alive":true,"file_ids":["7cdab430-184a-45c7-9611-d36aafb9ffd8"],"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"eb91d502-f67e-451a-8995-a2e11174454a":{"role":"reader","value":{"id":"eb91d502-f67e-451a-8995-a2e11174454a","version":199,"type":"bulleted_list","properties":{"title":[["after a new file written, the old version becomes garbage"]]},"created_time":1675461306546,"last_edited_time":1675461404474,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"ac780bf1-d858-403f-a984-529c37eb96de":{"role":"reader","value":{"id":"ac780bf1-d858-403f-a984-529c37eb96de","version":95,"type":"bulleted_list","properties":{"title":[["Approach 1 versioning file system",[["b"]]],[" (not in LFS): One could keep those older versions around and allow users to restore old file versions (for example, when they accidentally overwrite or delete a file, it could be quite handy to do so)"]]},"created_time":1675466545335,"last_edited_time":1675466625056,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"05545461-47a8-4d5a-9c33-44de1188eb74":{"role":"reader","value":{"id":"05545461-47a8-4d5a-9c33-44de1188eb74","version":50,"type":"bulleted_list","properties":{"title":[["Approach 2 garbage collection",[["b"]]],[": periodically find these old dead versions of file data, inodes, and other structures, and clean them"]]},"created_time":1675466566394,"last_edited_time":1675466650607,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"4f0c6ad0-282c-4b91-b3e4-b73fa16c54de":{"role":"reader","value":{"id":"4f0c6ad0-282c-4b91-b3e4-b73fa16c54de","version":202,"type":"bulleted_list","properties":{"title":[["Holes",[["b"]]],[": free blocks after garbage collection → harm to performance"]]},"created_time":1675466680985,"last_edited_time":1675466723992,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"517038c8-1e42-4370-bf4c-572886d35688":{"role":"reader","value":{"id":"517038c8-1e42-4370-bf4c-572886d35688","version":79,"type":"bulleted_list","properties":{"title":[["segment-by-segment clean",[["b"]]],[":"]]},"content":["bd1439dc-28a7-49c7-8fe6-985cb651b12d","1c8cc6e7-0f6b-4458-9ad9-fa8e603c9cc3","bd5c9956-a569-4bb9-a6f0-8b1b32893191","7ce0d703-bdfb-40e4-8a10-cea682df8377"],"created_time":1675466728932,"last_edited_time":1675467360032,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"bd1439dc-28a7-49c7-8fe6-985cb651b12d":{"role":"reader","value":{"id":"bd1439dc-28a7-49c7-8fe6-985cb651b12d","version":16,"type":"bulleted_list","properties":{"title":[["Periodically, the LFS cleaner reads in a number of old (partially-used) segments"]]},"created_time":1675467258871,"last_edited_time":1675467269340,"parent_id":"517038c8-1e42-4370-bf4c-572886d35688","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"1c8cc6e7-0f6b-4458-9ad9-fa8e603c9cc3":{"role":"reader","value":{"id":"1c8cc6e7-0f6b-4458-9ad9-fa8e603c9cc3","version":65,"type":"bulleted_list","properties":{"title":[["determines which blocks are live within these segments, and then write out a new set of segments with just the live blocks within them (a process of compact)"]]},"created_time":1675467270947,"last_edited_time":1675467338819,"parent_id":"517038c8-1e42-4370-bf4c-572886d35688","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"bd5c9956-a569-4bb9-a6f0-8b1b32893191":{"role":"reader","value":{"id":"bd5c9956-a569-4bb9-a6f0-8b1b32893191","version":13,"type":"bulleted_list","properties":{"title":[["freeing up the old ones for writing"]]},"created_time":1675467297409,"last_edited_time":1675467330339,"parent_id":"517038c8-1e42-4370-bf4c-572886d35688","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"7ce0d703-bdfb-40e4-8a10-cea682df8377":{"role":"reader","value":{"id":"7ce0d703-bdfb-40e4-8a10-cea682df8377","version":182,"type":"bulleted_list","properties":{"title":[["two important policies: determining liveness, clean schedule"]]},"created_time":1675467360031,"last_edited_time":1675467392736,"parent_id":"517038c8-1e42-4370-bf4c-572886d35688","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"d76ea078-ca92-4ffb-8576-2597d5fb5c10":{"role":"reader","value":{"id":"d76ea078-ca92-4ffb-8576-2597d5fb5c10","version":23,"type":"sub_sub_header","properties":{"title":[["Determining Block Liveness"]]},"created_time":1675467355968,"last_edited_time":1675467400356,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"7a3b9d8c-2548-406f-a307-1b517645836a":{"role":"reader","value":{"id":"7a3b9d8c-2548-406f-a307-1b517645836a","version":16,"type":"bulleted_list","properties":{"title":[["Given a data block D within an on disk segment S, LFS must be able to determine whether D is live"]]},"created_time":1675467400846,"last_edited_time":1675467596030,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"e372a48c-de77-4d17-b804-f77ec6c79f27":{"role":"reader","value":{"id":"e372a48c-de77-4d17-b804-f77ec6c79f27","version":51,"type":"bulleted_list","properties":{"title":[["segment summary block",[["b"]]],[": for each data block D, its inode number (which file it belongs to) and its offset (which block of the file this is)"]]},"content":["db142080-d902-4ad8-b970-49564b41ffd2","9aca9064-7842-428b-b0bb-2c2495793244","9595d5a2-09c7-427a-8575-f01f4b498270","69f520ec-8038-4b2c-9cdb-f4f36cc5c024","aa12c0fd-dfb0-4500-a6c2-055e2c466946","7e926ce8-9fe7-4ecc-b6cd-fd41cc3af633"],"created_time":1675467611595,"last_edited_time":1675468004737,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"db142080-d902-4ad8-b970-49564b41ffd2":{"role":"reader","value":{"id":"db142080-d902-4ad8-b970-49564b41ffd2","version":21,"type":"image","properties":{"size":[["35.6KB"]],"title":[["Untitled"]],"source":[["https://s3-us-west-2.amazonaws.com/secure.notion-static.com/0b42f013-7742-428f-aa7f-04dd9aa85824/Untitled.png"]]},"format":{"block_width":384,"display_source":"https://s3-us-west-2.amazonaws.com/secure.notion-static.com/0b42f013-7742-428f-aa7f-04dd9aa85824/Untitled.png","block_alignment":"center","block_full_width":false,"block_page_width":false,"block_aspect_ratio":0.2696929238985314,"block_preserve_scale":true},"created_time":1675467955206,"last_edited_time":1675467977129,"parent_id":"e372a48c-de77-4d17-b804-f77ec6c79f27","parent_table":"block","alive":true,"file_ids":["0b42f013-7742-428f-aa7f-04dd9aa85824"],"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"9aca9064-7842-428b-b0bb-2c2495793244":{"role":"reader","value":{"id":"9aca9064-7842-428b-b0bb-2c2495793244","version":33,"type":"numbered_list","properties":{"title":[["For a block D located on disk at address A, look in the segment summary block and find its inode number N and offset T."]]},"created_time":1675467676815,"last_edited_time":1675467780526,"parent_id":"e372a48c-de77-4d17-b804-f77ec6c79f27","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"9595d5a2-09c7-427a-8575-f01f4b498270":{"role":"reader","value":{"id":"9595d5a2-09c7-427a-8575-f01f4b498270","version":27,"type":"numbered_list","properties":{"title":[["look in the imap to find where N lives and read N from disk\n(perhaps it is already in memory, which is even better)."]]},"created_time":1675467775549,"last_edited_time":1675467788218,"parent_id":"e372a48c-de77-4d17-b804-f77ec6c79f27","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"69f520ec-8038-4b2c-9cdb-f4f36cc5c024":{"role":"reader","value":{"id":"69f520ec-8038-4b2c-9cdb-f4f36cc5c024","version":15,"type":"numbered_list","properties":{"title":[["using the offset T, look in the inode (or some indirect block) to see where the inode thinks the Tth block of this file is on disk."]]},"created_time":1675467785438,"last_edited_time":1675467809936,"parent_id":"e372a48c-de77-4d17-b804-f77ec6c79f27","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"aa12c0fd-dfb0-4500-a6c2-055e2c466946":{"role":"reader","value":{"id":"aa12c0fd-dfb0-4500-a6c2-055e2c466946","version":39,"type":"numbered_list","properties":{"title":[["if it points exactly to disk address A, LFS can conclude that the block D is live",[["b"]]],[". If it points anywhere else, LFS can conclude that D is not in use (i.e., it is dead) and thus know that this version is no longer needed"]]},"created_time":1675467857168,"last_edited_time":1675467903998,"parent_id":"e372a48c-de77-4d17-b804-f77ec6c79f27","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"7e926ce8-9fe7-4ecc-b6cd-fd41cc3af633":{"role":"reader","value":{"id":"7e926ce8-9fe7-4ecc-b6cd-fd41cc3af633","version":7,"type":"code","properties":{"title":[["(N, T) = SegmentSummary[A];\ninode = Read(imap[N]);\nif (inode[T] == A)\n// block D is alive\nelse\n// block D is garbage"]],"language":[["C++"]]},"format":{"code_wrap":false},"created_time":1675467904002,"last_edited_time":1675467904811,"parent_id":"e372a48c-de77-4d17-b804-f77ec6c79f27","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"0cda2b33-5eb8-4e90-9daf-7db1a495eb95":{"role":"reader","value":{"id":"0cda2b33-5eb8-4e90-9daf-7db1a495eb95","version":43,"type":"bulleted_list","properties":{"title":[["version number",[["b"]]],[": when a file is truncated or deleted, LFS increases its "],["version number",[["b"]]],[" and records the new version number in the imap. By also recording the version number in the on-disk segment, LFS can short circuit the longer check described above simply by comparing the on-disk version number with a version number in the imap, thus avoiding extra reads."]]},"created_time":1675467894274,"last_edited_time":1675468048521,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"a7bc7085-b3da-42db-ad30-4a6ff1b8137b":{"role":"reader","value":{"id":"a7bc7085-b3da-42db-ad30-4a6ff1b8137b","version":28,"type":"sub_sub_header","properties":{"title":[["Which Blocks To Clean, And When?"]]},"created_time":1675468075029,"last_edited_time":1675468104462,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"87a21fd3-c783-473b-aa61-c11ef148f494":{"role":"reader","value":{"id":"87a21fd3-c783-473b-aa61-c11ef148f494","version":44,"type":"bulleted_list","properties":{"title":[["When",[["b"]]],[": Either periodically, during "],["idle time",[["b"]]],[", or when you have to because the disk is "],["full",[["b"]]],["."]]},"created_time":1675468104730,"last_edited_time":1675468186709,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"d5b5dd61-ede1-48f3-8c91-2736cea777ff":{"role":"reader","value":{"id":"d5b5dd61-ede1-48f3-8c91-2736cea777ff","version":60,"type":"bulleted_list","properties":{"title":[["Which",[["b"]]],[": "],["Hot",[["i"]]],[" and "],["Cold",[["i"]]],[" segment"]]},"content":["180788a9-c21f-44f8-940c-01318e5a3484","0b740630-b4db-4a34-a226-0f792c9d50e0"],"created_time":1675468133275,"last_edited_time":1675468259004,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"180788a9-c21f-44f8-940c-01318e5a3484":{"role":"reader","value":{"id":"180788a9-c21f-44f8-940c-01318e5a3484","version":22,"type":"bulleted_list","properties":{"title":[["A hot segment is one in which the contents are being frequently over-written; thus, for such a segment, the best policy is to wait a long time before cleaning it, as more and more blocks are getting over-written (in new segments) and thus being freed for use."]]},"created_time":1675468200649,"last_edited_time":1675468223637,"parent_id":"d5b5dd61-ede1-48f3-8c91-2736cea777ff","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"0b740630-b4db-4a34-a226-0f792c9d50e0":{"role":"reader","value":{"id":"0b740630-b4db-4a34-a226-0f792c9d50e0","version":21,"type":"bulleted_list","properties":{"title":[["A cold segment, in contrast, may have a few dead blocks but the rest of its contents are relatively stable."]]},"created_time":1675468225173,"last_edited_time":1675468238201,"parent_id":"d5b5dd61-ede1-48f3-8c91-2736cea777ff","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"d59f5d04-8d23-4a9b-b604-8356d0a8ee8f":{"role":"reader","value":{"id":"d59f5d04-8d23-4a9b-b604-8356d0a8ee8f","version":23,"type":"sub_sub_header","properties":{"title":[["Crash Recovery And The Log"]]},"created_time":1675468258349,"last_edited_time":1675468266170,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"3511f076-d575-4ffa-8807-f65400f44fc8":{"role":"reader","value":{"id":"3511f076-d575-4ffa-8807-f65400f44fc8","version":60,"type":"bulleted_list","properties":{"title":[["Normal operation: LFS buffers writes in a segment, and then (when the segment is full, or when some amount of time has elapsed), writes the segment to disk. LFS organizes these writes in a "],["log",[["b"]]],[","]]},"created_time":1675468266730,"last_edited_time":1675468437224,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"c71a9615-c41c-45d3-b9fe-067568d82eb3":{"role":"reader","value":{"id":"c71a9615-c41c-45d3-b9fe-067568d82eb3","version":133,"type":"bulleted_list","properties":{"title":[["Two possible crashes: "],["write to CR",[["b"]]],[" and "],["write to segment",[["b"]]]]},"created_time":1675468699743,"last_edited_time":1675468727913,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"8257df10-916c-40ee-bad5-709186bcfef8":{"role":"reader","value":{"id":"8257df10-916c-40ee-bad5-709186bcfef8","version":109,"type":"bulleted_list","properties":{"title":[["atomic CR update",[["b"]]],[": LFS actually keeps two CRs, one at either end of the disk, and writes to them alternately, with protocol:"]]},"content":["03f20658-fb6d-4633-b638-8c7180452dee","95c05890-8a05-4dd1-b080-0b35398fa361","e5edc167-2980-4f25-84cf-1025ef6ad447","40c35055-4211-4859-a36f-ec599c0bc61e","dc72fa4e-e332-4ab7-8a27-716499bf55fe"],"created_time":1675468475818,"last_edited_time":1675468655488,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"03f20658-fb6d-4633-b638-8c7180452dee":{"role":"reader","value":{"id":"03f20658-fb6d-4633-b638-8c7180452dee","version":28,"type":"numbered_list","properties":{"title":[["writes out a header (with timestamp)"]]},"created_time":1675468534005,"last_edited_time":1675468580043,"parent_id":"8257df10-916c-40ee-bad5-709186bcfef8","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"95c05890-8a05-4dd1-b080-0b35398fa361":{"role":"reader","value":{"id":"95c05890-8a05-4dd1-b080-0b35398fa361","version":11,"type":"numbered_list","properties":{"title":[["the body of the CR"]]},"created_time":1675468567964,"last_edited_time":1675468578693,"parent_id":"8257df10-916c-40ee-bad5-709186bcfef8","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"e5edc167-2980-4f25-84cf-1025ef6ad447":{"role":"reader","value":{"id":"e5edc167-2980-4f25-84cf-1025ef6ad447","version":7,"type":"numbered_list","properties":{"title":[["one last block (also with a timestamp)"]]},"created_time":1675468580659,"last_edited_time":1675468588524,"parent_id":"8257df10-916c-40ee-bad5-709186bcfef8","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"40c35055-4211-4859-a36f-ec599c0bc61e":{"role":"reader","value":{"id":"40c35055-4211-4859-a36f-ec599c0bc61e","version":49,"type":"numbered_list","properties":{"title":[["If the system crashes during a CR update, LFS can detect this by seeing an "],["inconsistent pair of timestamps",[["b"]]]]},"created_time":1675468600038,"last_edited_time":1675468624629,"parent_id":"8257df10-916c-40ee-bad5-709186bcfef8","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"dc72fa4e-e332-4ab7-8a27-716499bf55fe":{"role":"reader","value":{"id":"dc72fa4e-e332-4ab7-8a27-716499bf55fe","version":135,"type":"numbered_list","properties":{"title":[["always choose to use the most recent CR with consistent timestamp"]]},"created_time":1675468632110,"last_edited_time":1675468645990,"parent_id":"8257df10-916c-40ee-bad5-709186bcfef8","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"3af48d27-4d24-4f50-a888-fde1f9a66063":{"role":"reader","value":{"id":"3af48d27-4d24-4f50-a888-fde1f9a66063","version":39,"type":"bulleted_list","properties":{"title":[["roll forward",[["b"]]],[": start with the last checkpoint region, find the end of the log (which is included in the CR), and then use that to read through the next segments and see if there are any valid updates within it"]]},"content":["7ae11138-e2ca-459b-a404-1f3d12f24992"],"created_time":1675468654864,"last_edited_time":1675470038164,"parent_id":"debd732f-edfa-46be-9da0-c67c2a2a3808","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"7ae11138-e2ca-459b-a404-1f3d12f24992":{"role":"reader","value":{"id":"7ae11138-e2ca-459b-a404-1f3d12f24992","version":20,"type":"bulleted_list","properties":{"title":[["If there are, LFS updates the file system accordingly and thus recovers much of the data and metadata written since the last checkpoint."]]},"created_time":1675469979954,"last_edited_time":1675470123326,"parent_id":"3af48d27-4d24-4f50-a888-fde1f9a66063","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","last_edited_by_table":"notion_user","last_edited_by_id":"8d91eb22-d5ae-4a85-ad77-d8911f5589a4","space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}}},"collection":{"57514c87-fdd3-44e3-81d2-4b83518ee9fa":{"role":"reader","value":{"id":"57514c87-fdd3-44e3-81d2-4b83518ee9fa","version":14,"name":[["Posts"]],"schema":{"NX\\Q":{"name":"date","type":"date"},"WxpT":{"name":"thumbnail","type":"file"},"`gQ~":{"name":"type","type":"select","options":[{"id":"5aff2f95-fd1e-489b-8840-bf10bc9519cb","color":"purple","value":"Post"},{"id":"374d2bc6-a144-4832-8ca4-474aaae0ea1f","color":"orange","value":"Paper"}]},"d]hq":{"name":"slug","type":"text"},"sD^m":{"name":"tags","type":"multi_select","options":[{"id":"57478946-4023-4c63-bb00-3df6b9a24994","color":"brown","value":"Open Source"},{"id":"75729654-d92f-4eb5-9e3c-2c283f63a4b1","color":"blue","value":"Daily"},{"id":"c0c435ce-d5ff-43ed-b1e4-710408dd6eed","color":"purple","value":"SEO"},{"id":"a7d0d4d2-18e9-4bf7-a6bf-2dacf5393e4b","color":"green","value":"Blog"},{"id":"6f46ca55-380f-4ea9-848b-ea2d3840989f","color":"gray","value":"Next.js"},{"id":"dac18998-86dd-4f18-8aa8-f83178854b3e","color":"red","value":"GraphQL"},{"id":"f4bef882-5fd4-4288-acb2-60cbaa69e265","color":"yellow","value":"Git"},{"id":"80cdf2bd-77ae-4fc4-8530-fc68e4863d76","color":"orange","value":"CSS"},{"id":"24c5a5bd-7f26-46d4-886e-fb5330985e2e","color":"pink","value":"Apollo"},{"id":"1b6bd16c-f115-438c-99c4-c4a327af9b23","color":"default","value":"Docs"},{"id":"dfa47c9a-d9af-459e-9c2d-9a40d7eb049c","color":"blue","value":"C++"},{"id":"f806ebb1-e3c5-4583-b2a6-1b2e54e838fa","color":"green","value":"Code"},{"id":"f7573f1b-6528-4198-9507-c648c34f0732","color":"pink","value":"Distributed System"},{"id":"377725a8-55be-4fd4-aa52-9ae5c427f2b5","color":"default","value":"Design"},{"id":"bc7fcd29-18ec-43ea-8dbb-723814d62383","color":"green","value":"Art"},{"id":"03f09615-175a-47eb-8362-326fe0162f01","color":"green","value":"School"},{"id":"491287b9-99b6-4c12-935a-80f12beacdf7","color":"red","value":"Storage System"}]},"wz|S":{"name":"summary","type":"text"},"zyLz":{"name":"updatedAt","type":"last_edited_time"},"~rC=":{"name":"author","type":"person","limit":1},"title":{"name":"title","type":"title"},"f211bdc0-ee00-4186-9a7d-f68c055ec2ee":{"name":"status","type":"select","options":[{"id":"22460321-fea2-4c7c-b352-a674760780ac","color":"orange","value":"Private"},{"id":"7abc61d4-b405-480d-b699-12588755fa65","color":"red","value":"Public"},{"id":"c7390b31-9fab-4e21-94ee-7e67ea077a97","color":"blue","value":"PublicOnDetail"}]}},"icon":"⚙️","format":{"copied_from_pointer":{"id":"08b37e3a-7ab6-4aff-9a85-38b9f164c5a1","table":"collection","spaceId":"81443245-8ca3-4444-b4b0-d1c233a71a25"},"collection_page_properties":[{"visible":false,"property":"NX\\Q"},{"visible":false,"property":"d]hq"},{"visible":false,"property":"~rC="},{"visible":false,"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"},{"visible":false,"property":"sD^m"},{"visible":false,"property":"wz|S"},{"visible":false,"property":"`gQ~"},{"visible":false,"property":"WxpT"},{"visible":true,"property":"zyLz"}]},"parent_id":"a9c51699-1e50-4bea-adcb-5057c5bddc7b","parent_table":"block","alive":true,"file_ids":["6cf3dc36-2f98-4f0e-9679-1bdbb1485129","5520bd92-e709-4c0d-ad58-06923f23f7e9","624d393a-62e3-4464-a1bf-1c79ecd4fbda","d52f6766-3e32-4c3d-8529-46e1f214360f"],"copied_from":"08b37e3a-7ab6-4aff-9a85-38b9f164c5a1","migrated":true,"space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}}},"space":{},"collection_view":{"07450bcb-93f3-4ef8-af09-a6b03629d439":{"role":"reader","value":{"id":"07450bcb-93f3-4ef8-af09-a6b03629d439","version":6,"type":"table","name":"Default view","format":{"table_wrap":false,"table_properties":[{"width":416,"visible":true,"property":"title"},{"width":186,"visible":true,"property":"d]hq"},{"width":124,"visible":true,"property":"f211bdc0-ee00-4186-9a7d-f68c055ec2ee"},{"width":100,"visible":true,"property":"`gQ~"},{"width":211,"visible":true,"property":"NX\\Q"},{"width":147,"visible":true,"property":"wz|S"},{"width":222,"visible":true,"property":"sD^m"},{"width":200,"visible":true,"property":"~rC="},{"width":200,"visible":true,"property":"WxpT"},{"width":200,"visible":true,"property":"zyLz"}]},"parent_id":"a9c51699-1e50-4bea-adcb-5057c5bddc7b","parent_table":"block","alive":true,"page_sort":["b1e1d645-db95-42e5-8995-39a80eda6460","e8cd3732-dc1c-43ae-959a-a5a611ec098a","e876558d-e878-47f6-8c95-21be678990a5","5a971ded-d3c5-41be-bef9-ddfff48d43a2","8db8b240-e1c5-4dd7-bf74-72584d7a2ce0","daf94ca4-ec56-47a3-84ed-b1e2479acc4b","d1a2db9b-6820-421e-9b80-017ce7478587","67ea9f83-b9f6-416b-afcb-7c64f7533e6c","45939470-9819-47e8-b12b-999cfefa0aad","c60dc33d-8efb-44be-a863-7a87ad047932","fe4b8d5f-7c49-42c6-a7d5-1cb71c4f7e86","b7233a67-c367-4198-831e-f12089568d1f","4f3bf306-92c4-41b7-a43e-957129a1240a","6a789607-66cf-498e-9b32-eb3fa69a84f4","c9429034-dabd-4a25-8782-97f20c808a60","38c49fe2-37f8-4a7f-a99f-9edb9ddad4c2","474eb638-9f6b-46bf-8004-77668293f199","81d6dfab-69cb-43a0-aa04-e9725f0b67e1","7703d956-84db-46cd-b538-48eae1af68b5","9f937c73-dac9-4ed7-9b01-beefcb321f16","3cf9dcb9-e7db-406c-80ab-c65c11fbf906","5827ab53-e051-455b-b90a-3bdc20158c2c","fa7acd3b-dea9-4fb1-b859-5345f35163c6","696dfc48-62c3-494d-96d0-ec5fa84637e8","79df93cf-9b10-452e-bc62-f39e8cd2d124","9bb8e52d-c459-4528-b1b3-c2378207253a","5da038ef-f419-4a11-aa48-587b3787e040","b4a2c9d4-6a2c-49e6-988d-89a538dfe0f6","c374a479-5cc7-4c54-ba69-6a4d76dc25ad","d470fa67-0e7c-40d8-86ac-9b5a8be88dc8","986be38b-9780-4bb9-bdcd-4e361ddbd888","b7613f56-c2d4-4aae-b967-b7471ade86d0","e357d1fc-7466-4d6a-8d48-71b76ea97cdc","e1735855-4089-4af6-bd4d-0d59f7a76cb4","9b34581a-955a-4229-99d0-8f2a6d0e69ce","b4414811-0599-45cf-b047-fa95eac42d89","c28a8a01-911a-40a2-a607-d3af8cb24017","461d07ae-4b4a-49de-bdcb-341af1153201","3df59023-cb68-4a65-afd1-7f0b8c21cb57","0e3223d1-03df-40fb-90f9-cc8559d776b5","4f45b7d6-cd5b-46ab-b2a6-37ae20bf5f21","fa475a21-5f38-43d4-9a89-67c40b3129ae","97cbc634-fe3a-4b9b-9da6-ac4aaa94772f","8a0d34bc-7e8c-4a68-88a5-5276274f612a","623f8788-a20f-45fd-bb82-08935f59b44d","7ee398f0-450b-47cb-9b53-f5e7736590d2","eae9f077-591e-4841-903b-db395513c834","367d0f2a-0b10-4dbb-b53a-613152f124f9","398e2e28-3997-49bc-a138-0467d4da8531","8aaf4633-e879-44dc-82c8-3c9fb9d3a6f8","1eb5e5f2-8dc9-4ffc-b5e1-09b67be27a83","83465fb9-205b-41fc-83a6-424692ee0a0e","fb1d18d0-6403-4e8a-840e-134553748ff5","4407cb77-3838-4ba5-b474-f15222cd3dba","1880b0f2-e036-42d0-9550-0fb08a962397","d8d60bd6-33f6-458f-a7d6-209ef2fb05a1","29bf65ff-888b-4a76-a8dd-bf54f02c3864","bad1d4ae-fd4a-4671-ae94-dd53d94e0eae","0d59792d-db1c-4ae7-8d7c-4f013be40dcf","337dc259-2805-4b1c-a60f-1b3e6c7badb8","4b1b21a8-c278-4bc6-88f1-1a35d407f4d7","7946aba2-d6d0-45ef-8779-23fa15db8f2d","c18dbce6-9e8c-4f4b-b74a-0994e7c1bc3f","84aa87b7-39e7-493c-87b9-5cae4de95449","1446eadb-8c01-4295-be3a-ecf19361c143","fe8a7d94-e9ba-457d-8f19-10fe53e6ca3c","98a5a0b6-b07b-4065-a73f-2949ad28ac47","f6a9f979-d19f-4b19-80b4-8b25bf8fa75d","3d3599eb-c3e3-4e4c-92b6-8cce6274fc02","37d3ec96-b340-484d-9538-635a6e7aa17d","306a0523-c59d-47c8-bf10-2dee83f339fb","9b5be59b-da72-4a4a-9ccf-cc4b82601184","68ffaa07-c97c-4d3a-a672-cc025dacdb1c","4bc3f405-5c60-474e-9dab-3b1837cfb927","7c9a700d-552d-474c-8fad-ce3f749e96c9","411264c9-9c90-4c2d-9918-b32b00da1ed5","b4467951-987d-48a9-a0f2-49bd8dea6f80","1f353b55-10d1-4948-a48a-1045477599ad","4d562b1e-3a10-4963-b26e-61c9509607fa","598890d1-899f-4700-afe3-f756078874a5","724413ed-8a55-465f-9817-29cb6308d0b6","909a6375-3e4d-488f-aa01-8ef717eecfa3","ce18cb57-eada-415b-a662-5c4dbffab48e","79ef1b90-1bde-4b99-ab7f-70906fa45d2d","95c980b3-02ce-42e1-8cbf-8026f57c9ce2","6ba0c050-11ca-4969-b48a-79433df542ff","4dd8c68b-88c4-48b6-919a-4fbc6a8b466a","e2ba87f5-bf7c-4565-9a3d-1082b90a4212","f94d7c22-3964-44f3-89e1-88a246d75864","9d60b800-3bf4-46de-90f0-9b188df24a02","b76139ef-a0a3-489d-a9e7-a176e431937a","f41686f6-a6bf-4292-aa4d-168d3e019b4b","1166bba8-a1cd-4fd6-8f6a-c0cbe10d5d35","a2ff0612-c4d1-41fc-8c2d-1554d891557e","90a59f89-1ba4-4b2c-bbef-d07c470bfc9c","fedc0e94-1316-4399-9f39-6f4de74f850b","9db0bb99-f6da-40d9-a966-52d3b3a30f9d","2cd2bd7c-73ef-4394-87dd-0fc9f085dba2","56c0c047-a4ac-4a02-a2e1-dc7d5405b8de","bddc3ba9-e218-42f9-bac8-497ace880977","975051d4-ebbc-4b3f-98cf-1a52e5e4761d","e5d98bee-b2d5-4b45-ab0b-b77da24aebe7","acac2668-1062-4e7a-b095-eda067da8413","179025c4-d8a8-4c47-b621-9fd6a6f3339b","d256e5ed-5eac-43bb-a32e-581774962c23","2434e1f8-19d2-40b5-bae2-b6d75ead060c","9a4e4502-c2ff-4c7b-897a-02f9b68f15c6","9c40a253-b9e8-42cd-8a99-62aaa9789a5e","e2600427-334a-401b-b5a8-54c18a540729","dac360d9-fb47-443f-ab93-55a2c42ad135","29b559aa-056d-44a5-ab18-bb96b6836f55","e72b33b4-441c-48e7-8dac-75abf0401ec9","f57060f7-3ae6-46f6-9ad7-2f1ec35d8ad6","44b17d52-2e29-4148-ad09-93cf66a65f84","dd62c606-8a7d-4ab9-87b6-8cd25531a3cb","5001fe4a-256c-46d1-86ef-74fd85735b96","603f9641-669d-4eb5-ac18-165aa5bdfa12","e5e3f04f-16fc-4cc2-a84b-c6658b11a0a4","0107fc94-a69a-4008-ad6f-b6d3a745109d","fa14a437-e681-4d6a-b1cf-179d64bd13aa","d812d1db-f99e-4290-b5dd-e46060c68982","f7f9f4a6-5a18-4762-a045-438bc160184f","eaa3ba59-09e2-45eb-90c3-4ad0eb2c320a","d35e5c3a-fbeb-4462-b808-503a4b3ad29b","4f9e8264-87f9-4a58-9bdb-504052f4784e","73219e21-da53-4127-8f35-6d9310a1bada","07b74537-2ab7-429c-a132-80c57c60f8e8","581263ed-5a68-440a-bb31-df7d5fc80708","79fc8bfb-f588-4c81-8668-39ff75d75083","91bc421a-2869-464e-a0eb-02fad84829c4","fd7228ee-f538-46d9-b2c9-8210d51798c6","d29cb589-1334-46d2-8cec-067b4bf27ce4","70f7eb66-be65-4b76-ae4e-bbc0c61579ca","63f574c2-0d91-46af-8ba0-a1bfb5685a69","9a2bc4bd-08e3-4ef4-8c2d-c01e71a455a1","51e53e64-e6dd-4fd6-8062-5d4455f0a1cb","f4ec684b-e5f1-44e9-a8a7-aca27f7ca6f3","177fa228-9099-4dd5-8969-c67f9c78bd0c","d5ab0d7a-0123-473f-84d4-81740defb9b4","548f6d36-c509-4b79-9c4b-59f227c7f550","c0901673-4f5e-4e51-ad87-0217f2d33a0c","0787f8d6-dc99-47c6-946e-2b008814bebc","0ade5216-1103-486a-aff0-a709ff825b02","a2c4dd21-985c-497d-b421-c2d8a9ec0eeb","908a498c-f7e3-4668-8afd-f179a027b4d9","4945e5c3-033d-467c-a8b3-b1479c1fdf0a","854f4584-28d5-43bd-938e-88d0957c78e3","6a6574f8-d63d-4fed-99c5-38f3df0364ac"],"query2":{"sort":[{"property":"NX\\Q","direction":"descending"}],"aggregations":[{"property":"title","aggregator":"count"}]},"space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}},"2bdcebad-9bb0-4b80-9a68-88d71dc88dc1":{"role":"reader","value":{"id":"2bdcebad-9bb0-4b80-9a68-88d71dc88dc1","version":46,"type":"table","parent_id":"a9c51699-1e50-4bea-adcb-5057c5bddc7b","parent_table":"block","alive":true,"page_sort":["95c980b3-02ce-42e1-8cbf-8026f57c9ce2","6ba0c050-11ca-4969-b48a-79433df542ff","4dd8c68b-88c4-48b6-919a-4fbc6a8b466a","e2ba87f5-bf7c-4565-9a3d-1082b90a4212","d0e5e87c-430f-4829-bc8e-03886c4178a8","0ebd6c33-f48b-4ac3-ad75-7fbad9bc9a77","debd732f-edfa-46be-9da0-c67c2a2a3808","78706164-6f94-484e-b3a3-355f94680e78","6d8147f6-ed76-456a-8323-f3baa81cd488","2cd2bd7c-73ef-4394-87dd-0fc9f085dba2","f94d7c22-3964-44f3-89e1-88a246d75864","9d60b800-3bf4-46de-90f0-9b188df24a02","f41686f6-a6bf-4292-aa4d-168d3e019b4b","b76139ef-a0a3-489d-a9e7-a176e431937a","90a59f89-1ba4-4b2c-bbef-d07c470bfc9c","fedc0e94-1316-4399-9f39-6f4de74f850b","9db0bb99-f6da-40d9-a966-52d3b3a30f9d","42a50dcf-af92-4b77-8ade-226e91a940eb","703164e2-e3e7-4bbe-a49d-4ce8553737b4","e6c10e15-1991-42f7-967c-e36d9fd42a12","9c8cb5e6-9a2e-42ff-b459-f96c21ba1f1e","c11ded5b-09a3-4f63-a5bc-30a34fd799e6","f7cfbe97-b6e0-4dd3-b206-95dafaa395db","0c405f31-f0db-4558-97e1-bd53dded9f12","70da6269-ce96-4cbf-a023-553ff7d193eb","1ad37934-8a19-4540-b21e-3910b835e8cc","2fb3a42d-f6aa-4a56-8b3f-d4bf7692bba3","280f2d3c-8715-4ad7-b19c-e52450f7c907"],"space_id":"a9502724-d7a1-44ec-8237-1b7455afe793"}}},"notion_user":{},"collection_query":{},"signed_urls":{"d98b88ac-7f3e-406f-ba39-5ec723b33abc":"https://s3.us-west-2.amazonaws.com/secure.notion-static.com/005620bc-4370-47ec-a44b-518e73bd0a2e/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Content-Sha256=UNSIGNED-PAYLOAD\u0026X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230205%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20230205T233244Z\u0026X-Amz-Expires=86400\u0026X-Amz-Signature=c1c1fa77eb1dcabc50bf575fe821a12851e0e1bc9accc6f6ce19d1e253d58245\u0026X-Amz-SignedHeaders=host\u0026x-id=GetObject","c2f307f4-7574-433e-bd38-d8eaba5586e0":"https://s3.us-west-2.amazonaws.com/secure.notion-static.com/5250324f-8165-4203-bd8f-9f6a55792a67/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Content-Sha256=UNSIGNED-PAYLOAD\u0026X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230205%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20230205T233244Z\u0026X-Amz-Expires=86400\u0026X-Amz-Signature=0be9d390633c6527a4e6087c37ac34194c4c2d4ee77d94b3ca0c65c55b4a5abd\u0026X-Amz-SignedHeaders=host\u0026x-id=GetObject","904b1291-5dc5-4527-a310-f3100909508a":"https://s3.us-west-2.amazonaws.com/secure.notion-static.com/63cf8be1-b82c-4f9a-9e3b-649027b5977c/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Content-Sha256=UNSIGNED-PAYLOAD\u0026X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230205%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20230205T233244Z\u0026X-Amz-Expires=86400\u0026X-Amz-Signature=d73fddb05104a917c9793056b1e3d8524d2bfad8f8805034e489b5d2ceeb86d7\u0026X-Amz-SignedHeaders=host\u0026x-id=GetObject","750fd85d-9454-44d5-9423-f2d6f8d778c0":"https://s3.us-west-2.amazonaws.com/secure.notion-static.com/1b8b6ada-aa48-4c24-801b-c7656aac6aa8/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Content-Sha256=UNSIGNED-PAYLOAD\u0026X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230205%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20230205T233244Z\u0026X-Amz-Expires=86400\u0026X-Amz-Signature=3b793ac57135682374d238cad1b6abb13aa05a52744c7d9006f728937a0cc987\u0026X-Amz-SignedHeaders=host\u0026x-id=GetObject","47f8f04c-83c5-4ddc-a1ba-8bc34357102b":"https://s3.us-west-2.amazonaws.com/secure.notion-static.com/f08a4e0e-6d13-4836-bca3-f6d408d8f641/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Content-Sha256=UNSIGNED-PAYLOAD\u0026X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230205%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20230205T233244Z\u0026X-Amz-Expires=86400\u0026X-Amz-Signature=41816097bd1329beccfb1c897e6abd73f2a3d0f6a101d6ecef1b35ca8a49ee21\u0026X-Amz-SignedHeaders=host\u0026x-id=GetObject","51963fd6-e0b9-43cc-b1bf-5c59a6896de4":"https://s3.us-west-2.amazonaws.com/secure.notion-static.com/7cdab430-184a-45c7-9611-d36aafb9ffd8/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Content-Sha256=UNSIGNED-PAYLOAD\u0026X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230205%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20230205T233244Z\u0026X-Amz-Expires=86400\u0026X-Amz-Signature=d78de25ee6c724e5fde7203681ee2b4fa6e28e9f7b2fb3c75a66be4b6d44c9a6\u0026X-Amz-SignedHeaders=host\u0026x-id=GetObject","db142080-d902-4ad8-b970-49564b41ffd2":"https://s3.us-west-2.amazonaws.com/secure.notion-static.com/0b42f013-7742-428f-aa7f-04dd9aa85824/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Content-Sha256=UNSIGNED-PAYLOAD\u0026X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230205%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20230205T233244Z\u0026X-Amz-Expires=86400\u0026X-Amz-Signature=f7bef2b9e70a89d3a5275d1ebe268beb6820708f3bfcf770aece122380924cf8\u0026X-Amz-SignedHeaders=host\u0026x-id=GetObject"}}},"__N_SSG":true},"page":"/[slug]","query":{"slug":"lfs"},"buildId":"8opMz6MOLcCZ8Eu3Yf9uw","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>